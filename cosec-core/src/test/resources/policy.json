{
  "id": "2",
  "name": "auth",
  "category": "auth",
  "description": "",
  "type": "global",
  "tenantId": "1",
  "statements": [
    {
      "effect": "allow",
      "actions": [
        {
          "type": "all"
        },
        {
          "type": "none"
        },
        {
          "type": "path",
          "methods": [
            "GET",
            "POST",
            "PUT",
            "DELETE"
          ],
          "pattern": "/user/{userId}/*"
        }
      ],
      "conditions": [
        {
          "type": "authenticated"
        },
        {
          "type": "in",
          "part": "context.principal.id",
          "in": [
            "userId"
          ]
        },
        {
          "type": "path",
          "part": "request.remoteIp",
          "path": {
            "caseSensitive": false,
            "separator": ".",
            "decodeAndParseSegments": false
          },
          "pattern": "192.168.0.*"
        }
      ]
    },
    {
      "effect": "deny",
      "actions": [
        {
          "type": "all",
          "methods": [
            "GET"
          ]
        },
        {
          "type": "none"
        },
        {
          "type": "path",
          "pattern": ".*"
        },
        {
          "type": "path",
          "pattern": "#{principal.id}.*"
        },
        {
          "type": "reg",
          "pattern": ".*"
        },
        {
          "type": "reg",
          "pattern": "#{principal.id}.*"
        }
      ],
      "conditions": [
        {
          "type": "all"
        },
        {
          "type": "none"
        },
        {
          "type": "spel",
          "pattern": "context.principal.id=='1'"
        },
        {
          "type": "ognl",
          "pattern": "path == \"auth/login\""
        }
      ]
    }
  ]
}

<?xml version="1.0" encoding="UTF-8" standalone="no"?><!--
  - Copyright [2021-present] [ahoo wang <ahoowang@qq.com> (https://github.com/Ahoo-Wang)].
  - Licensed under the Apache License, Version 2.0 (the "License");
  - you may not use this file except in compliance with the License.
  - You may obtain a copy of the License at
  -      http://www.apache.org/licenses/LICENSE-2.0
  - Unless required by applicable law or agreed to in writing, software
  - distributed under the License is distributed on an "AS IS" BASIS,
  - WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  - See the License for the specific language governing permissions and
  - limitations under the License.
  -->

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="948px" preserveAspectRatio="none" style="width:497px;height:948px;background:#FFFFFF;" version="1.1" viewBox="0 0 497 948" width="497px" zoomAndPan="magnify"><defs/><g><a href="https://github.com/Ahoo-Wang/CoSec" target="_top" title="https://github.com/Ahoo-Wang/CoSec" xlink:actuate="onRequest" xlink:href="https://github.com/Ahoo-Wang/CoSec" xlink:show="new" xlink:title="https://github.com/Ahoo-Wang/CoSec" xlink:type="simple"><text fill="#808080" font-family="sans-serif" font-size="10" lengthAdjust="spacing" text-decoration="underline" textLength="189" x="295.5" y="19.668">https://github.com/Ahoo-Wang/CoSec</text></a><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="354" x="70.25" y="46.3125">Authorization.authorize(Request,SecurityContext)</text><ellipse cx="191" cy="70.2656" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><rect fill="#F1F1F1" height="34.1328" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="221" x="80.5" y="100.2656"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="201" x="90.5" y="121.8672">authorize(Request,SecurityContext)</text><rect fill="none" height="355.0195" style="stroke:#000000;stroke-width:1.5;" width="473.5" x="11" y="144.3984"/><path d="M120,144.3984 L120,153.8867 L110,163.8867 L11,163.8867 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="14" y="158.9336">Global Policies</text><rect fill="#F1F1F1" height="34.1328" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="128" y="180.8867"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="106" x="138" y="202.4883">get Global policies</text><rect fill="#F1F1F1" height="34.1328" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="138" x="122" y="235.0195"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="118" x="132" y="256.6211">get Deny Statements</text><polygon fill="#F1F1F1" points="100.5,289.1523,281.5,289.1523,293.5,301.1523,281.5,313.1523,100.5,313.1523,88.5,301.1523,100.5,289.1523" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="181" x="100.5" y="305.3096">verify request using Deny policies</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="22" x="66.5" y="298.832">true</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="25" x="293.5" y="298.832">false</text><rect fill="#F1F1F1" height="34.1328" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="96" x="23" y="323.1523"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="76" x="33" y="344.7539">deny request</text><ellipse cx="71" cy="388.2852" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="71" cy="388.2852" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><rect fill="#F1F1F1" height="34.1328" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="241.5" y="323.1523"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="119" x="251.5" y="344.7539">get Allow Statements</text><polygon fill="#F1F1F1" points="219.5,377.2852,402.5,377.2852,414.5,389.2852,402.5,401.2852,219.5,401.2852,207.5,389.2852,219.5,377.2852" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="183" x="219.5" y="393.4424">verify request using Allow policies</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="22" x="185.5" y="386.9648">true</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="25" x="414.5" y="386.9648">false</text><rect fill="#F1F1F1" height="34.1328" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="97" x="149" y="411.2852"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="77" x="159" y="432.8867">allow request</text><ellipse cx="197.5" cy="476.418" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="197.5" cy="476.418" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><rect fill="#F1F1F1" height="34.1328" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="92" x="378.5" y="411.2852"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="72" x="388.5" y="432.8867">Role policies</text><rect fill="none" height="373.0195" style="stroke:#000000;stroke-width:1.5;" width="475.5" x="11" y="509.418"/><path d="M106,509.418 L106,518.9063 L96,528.9063 L11,528.9063 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="14" y="523.9531">Role Policies</text><rect fill="#F1F1F1" height="34.1328" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="134" y="545.9063"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="94" x="144" y="567.5078">get Role policies</text><rect fill="#F1F1F1" height="34.1328" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="138" x="122" y="600.0391"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="118" x="132" y="621.6406">get Deny Statements</text><polygon fill="#F1F1F1" points="100.5,654.1719,281.5,654.1719,293.5,666.1719,281.5,678.1719,100.5,678.1719,88.5,666.1719,100.5,654.1719" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="181" x="100.5" y="670.3291">verify request using Deny policies</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="22" x="66.5" y="663.8516">true</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="25" x="293.5" y="663.8516">false</text><rect fill="#F1F1F1" height="34.1328" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="96" x="23" y="688.1719"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="76" x="33" y="709.7734">deny request</text><rect fill="#F1F1F1" height="34.1328" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="241.5" y="688.1719"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="119" x="251.5" y="709.7734">get Allow Statements</text><polygon fill="#F1F1F1" points="219.5,742.3047,402.5,742.3047,414.5,754.3047,402.5,766.3047,219.5,766.3047,207.5,754.3047,219.5,742.3047" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="183" x="219.5" y="758.4619">verify request using Allow policies</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="22" x="185.5" y="751.9844">true</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="25" x="414.5" y="751.9844">false</text><rect fill="#F1F1F1" height="34.1328" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="97" x="149" y="776.3047"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="77" x="159" y="797.9063">allow request</text><rect fill="#F1F1F1" height="34.1328" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="96" x="376.5" y="776.3047"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="76" x="386.5" y="797.9063">deny request</text><polygon fill="#F1F1F1" points="311,816.4375,323,828.4375,311,840.4375,299,828.4375,311,816.4375" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#F1F1F1" points="191,846.4375,203,858.4375,191,870.4375,179,858.4375,191,846.4375" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="191" cy="913.4375" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="191" cy="913.4375" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="191" x2="191" y1="80.2656" y2="100.2656"/><polygon fill="#181818" points="187,90.2656,191,100.2656,195,90.2656,191,94.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="191" x2="191" y1="215.0195" y2="235.0195"/><polygon fill="#181818" points="187,225.0195,191,235.0195,195,225.0195,191,229.0195" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="71" x2="71" y1="357.2852" y2="377.2852"/><polygon fill="#181818" points="67,367.2852,71,377.2852,75,367.2852,71,371.2852" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="197.5" x2="197.5" y1="445.418" y2="465.418"/><polygon fill="#181818" points="193.5,455.418,197.5,465.418,201.5,455.418,197.5,459.418" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="207.5" x2="197.5" y1="389.2852" y2="389.2852"/><line style="stroke:#181818;stroke-width:1.0;" x1="197.5" x2="197.5" y1="389.2852" y2="411.2852"/><polygon fill="#181818" points="193.5,401.2852,197.5,411.2852,201.5,401.2852,197.5,405.2852" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="414.5" x2="424.5" y1="389.2852" y2="389.2852"/><line style="stroke:#181818;stroke-width:1.0;" x1="424.5" x2="424.5" y1="389.2852" y2="411.2852"/><polygon fill="#181818" points="420.5,401.2852,424.5,411.2852,428.5,401.2852,424.5,405.2852" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="424.5" x2="424.5" y1="445.418" y2="492.418"/><line style="stroke:#181818;stroke-width:1.0;" x1="424.5" x2="191" y1="492.418" y2="492.418"/><line style="stroke:#181818;stroke-width:1.0;" x1="191" x2="191" y1="492.418" y2="545.9063"/><polygon fill="#181818" points="187,535.9063,191,545.9063,195,535.9063,191,539.9063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="311" x2="311" y1="357.2852" y2="377.2852"/><polygon fill="#181818" points="307,367.2852,311,377.2852,315,367.2852,311,371.2852" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="88.5" x2="71" y1="301.1523" y2="301.1523"/><line style="stroke:#181818;stroke-width:1.0;" x1="71" x2="71" y1="301.1523" y2="323.1523"/><polygon fill="#181818" points="67,313.1523,71,323.1523,75,313.1523,71,317.1523" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="293.5" x2="311" y1="301.1523" y2="301.1523"/><line style="stroke:#181818;stroke-width:1.0;" x1="311" x2="311" y1="301.1523" y2="323.1523"/><polygon fill="#181818" points="307,313.1523,311,323.1523,315,313.1523,311,317.1523" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="191" x2="191" y1="269.1523" y2="289.1523"/><polygon fill="#181818" points="187,279.1523,191,289.1523,195,279.1523,191,283.1523" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="191" x2="191" y1="134.3984" y2="180.8867"/><polygon fill="#181818" points="187,170.8867,191,180.8867,195,170.8867,191,174.8867" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="191" x2="191" y1="580.0391" y2="600.0391"/><polygon fill="#181818" points="187,590.0391,191,600.0391,195,590.0391,191,594.0391" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="207.5" x2="197.5" y1="754.3047" y2="754.3047"/><line style="stroke:#181818;stroke-width:1.0;" x1="197.5" x2="197.5" y1="754.3047" y2="776.3047"/><polygon fill="#181818" points="193.5,766.3047,197.5,776.3047,201.5,766.3047,197.5,770.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="414.5" x2="424.5" y1="754.3047" y2="754.3047"/><line style="stroke:#181818;stroke-width:1.0;" x1="424.5" x2="424.5" y1="754.3047" y2="776.3047"/><polygon fill="#181818" points="420.5,766.3047,424.5,776.3047,428.5,766.3047,424.5,770.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="197.5" x2="197.5" y1="810.4375" y2="828.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="197.5" x2="299" y1="828.4375" y2="828.4375"/><polygon fill="#181818" points="289,824.4375,299,828.4375,289,832.4375,293,828.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="424.5" x2="424.5" y1="810.4375" y2="828.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="424.5" x2="323" y1="828.4375" y2="828.4375"/><polygon fill="#181818" points="333,824.4375,323,828.4375,333,832.4375,329,828.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="311" x2="311" y1="722.3047" y2="742.3047"/><polygon fill="#181818" points="307,732.3047,311,742.3047,315,732.3047,311,736.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="88.5" x2="71" y1="666.1719" y2="666.1719"/><line style="stroke:#181818;stroke-width:1.0;" x1="71" x2="71" y1="666.1719" y2="688.1719"/><polygon fill="#181818" points="67,678.1719,71,688.1719,75,678.1719,71,682.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="293.5" x2="311" y1="666.1719" y2="666.1719"/><line style="stroke:#181818;stroke-width:1.0;" x1="311" x2="311" y1="666.1719" y2="688.1719"/><polygon fill="#181818" points="307,678.1719,311,688.1719,315,678.1719,311,682.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="71" x2="71" y1="722.3047" y2="858.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="71" x2="179" y1="858.4375" y2="858.4375"/><polygon fill="#181818" points="169,854.4375,179,858.4375,169,862.4375,173,858.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="311" x2="311" y1="840.4375" y2="858.4375"/><line style="stroke:#181818;stroke-width:1.0;" x1="311" x2="203" y1="858.4375" y2="858.4375"/><polygon fill="#181818" points="213,854.4375,203,858.4375,213,862.4375,209,858.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="191" x2="191" y1="634.1719" y2="654.1719"/><polygon fill="#181818" points="187,644.1719,191,654.1719,195,644.1719,191,648.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="191" x2="191" y1="870.4375" y2="902.4375"/><polygon fill="#181818" points="187,892.4375,191,902.4375,195,892.4375,191,896.4375" style="stroke:#181818;stroke-width:1.0;"/><a href="https://github.com/Ahoo-Wang/CoSec" target="_top" title="https://github.com/Ahoo-Wang/CoSec" xlink:actuate="onRequest" xlink:href="https://github.com/Ahoo-Wang/CoSec" xlink:show="new" xlink:title="https://github.com/Ahoo-Wang/CoSec" xlink:type="simple"><text fill="#808080" font-family="sans-serif" font-size="10" lengthAdjust="spacing" text-decoration="underline" textLength="189" x="152.75" y="933.1055">https://github.com/Ahoo-Wang/CoSec</text></a><!--MD5=[fdab6c6972ac32a753062d4e384c7834]
@startuml
!include layout.puml
title Authorization.authorize(Request,SecurityContext)
start
:authorize(Request,SecurityContext);
group Global Policies
:get Global policies;
:get Deny Statements;
if (verify request using Deny policies) is (true) then
  :deny request;
  stop
else (false)
  :get Allow Statements;
  if (verify request using Allow policies) is (true) then
    :allow request;
    stop
  else (false)
  :Role policies;
  endif
endif
end group

group Role Policies
:get Role policies;
:get Deny Statements;
if (verify request using Deny policies) is (true) then
  :deny request;
else (false)
  :get Allow Statements;
  if (verify request using Allow policies) is (true) then
    :allow request;
  else (false)
    :deny request;
  endif
endif
end group
stop
@enduml

@startuml
skinparam hyperlinkColor grey


header
[[https://github.com/Ahoo-Wang/CoSec]]
endheader

center footer [[https://github.com/Ahoo-Wang/CoSec]]

title Authorization.authorize(Request,SecurityContext)
start
:authorize(Request,SecurityContext);
group Global Policies
:get Global policies;
:get Deny Statements;
if (verify request using Deny policies) is (true) then
  :deny request;
  stop
else (false)
  :get Allow Statements;
  if (verify request using Allow policies) is (true) then
    :allow request;
    stop
  else (false)
  :Role policies;
  endif
endif
end group

group Role Policies
:get Role policies;
:get Deny Statements;
if (verify request using Deny policies) is (true) then
  :deny request;
else (false)
  :get Allow Statements;
  if (verify request using Allow policies) is (true) then
    :allow request;
  else (false)
    :deny request;
  endif
endif
end group
stop
@enduml

PlantUML version 1.2022.13(Sat Nov 19 21:22:17 CST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>
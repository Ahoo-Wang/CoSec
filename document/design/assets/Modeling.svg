<?xml version="1.0" encoding="UTF-8" standalone="no"?><!--
  - Copyright [2021-present] [ahoo wang <ahoowang@qq.com> (https://github.com/Ahoo-Wang)].
  - Licensed under the Apache License, Version 2.0 (the "License");
  - you may not use this file except in compliance with the License.
  - You may obtain a copy of the License at
  -      http://www.apache.org/licenses/LICENSE-2.0
  - Unless required by applicable law or agreed to in writing, software
  - distributed under the License is distributed on an "AS IS" BASIS,
  - WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  - See the License for the specific language governing permissions and
  - limitations under the License.
  -->

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="818px" preserveAspectRatio="none" style="width:2984px;height:818px;background:#FFFFFF;" version="1.1" viewBox="0 0 2984 818" width="2984px" zoomAndPan="magnify"><defs/><g><a href="https://github.com/Ahoo-Wang/CoSec" target="_top" title="https://github.com/Ahoo-Wang/CoSec" xlink:actuate="onRequest" xlink:href="https://github.com/Ahoo-Wang/CoSec" xlink:show="new" xlink:title="https://github.com/Ahoo-Wang/CoSec" xlink:type="simple"><text fill="#808080" font-family="sans-serif" font-size="10" lengthAdjust="spacing" text-decoration="underline" textLength="189" x="2781" y="9.668">https://github.com/Ahoo-Wang/CoSec</text></a><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="224" x="1373" y="36.3125">CoSec Modeling Class Diagram</text><!--MD5=[158ea172665500f9d1b87622b0f57e22]
cluster tenant--><g id="cluster_tenant"><path d="M138.5,64.2656 L185.5,64.2656 A3.75,3.75 0 0 1 188,66.7656 L195,86.7539 L561.5,86.7539 A2.5,2.5 0 0 1 564,89.2539 L564,350.7656 A2.5,2.5 0 0 1 561.5,353.2656 L138.5,353.2656 A2.5,2.5 0 0 1 136,350.7656 L136,66.7656 A2.5,2.5 0 0 1 138.5,64.2656 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="136" x2="195" y1="86.7539" y2="86.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="46" x="140" y="79.8008">tenant</text></g><!--MD5=[73372e1614ca5de955321ff74365eabf]
cluster policy--><g id="cluster_policy"><path d="M1933.5,56.2656 L1977.5,56.2656 A3.75,3.75 0 0 1 1980,58.7656 L1987,78.7539 L2974.5,78.7539 A2.5,2.5 0 0 1 2977,81.2539 L2977,789.7656 A2.5,2.5 0 0 1 2974.5,792.2656 L1933.5,792.2656 A2.5,2.5 0 0 1 1931,789.7656 L1931,58.7656 A2.5,2.5 0 0 1 1933.5,56.2656 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1931" x2="1987" y1="78.7539" y2="78.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="43" x="1935" y="71.8008">policy</text></g><!--MD5=[d119c4a9d5e0dd9c185bd0ddda62ab2d]
cluster principal--><g id="cluster_principal"><path d="M627.5,213.2656 L691.5,213.2656 A3.75,3.75 0 0 1 694,215.7656 L701,235.7539 L1241.5,235.7539 A2.5,2.5 0 0 1 1244,238.2539 L1244,533.2656 A2.5,2.5 0 0 1 1241.5,535.7656 L627.5,535.7656 A2.5,2.5 0 0 1 625,533.2656 L625,215.7656 A2.5,2.5 0 0 1 627.5,213.2656 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="625" x2="701" y1="235.7539" y2="235.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="63" x="629" y="228.8008">principal</text></g><!--MD5=[67892945c51b45dfa1cd11fc454571f7]
cluster java.security--><g id="cluster_java.security"><path d="M762.5,72.7656 L852.5,72.7656 A3.75,3.75 0 0 1 855,75.2656 L862,95.2539 L917.5,95.2539 A2.5,2.5 0 0 1 920,97.7539 L920,185.2656 A2.5,2.5 0 0 1 917.5,187.7656 L762.5,187.7656 A2.5,2.5 0 0 1 760,185.2656 L760,75.2656 A2.5,2.5 0 0 1 762.5,72.7656 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="760" x2="862" y1="95.2539" y2="95.2539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="89" x="764" y="88.3008">java.security</text></g><!--MD5=[7f1db14b27b7629509c802e44e13c9c4]
cluster context--><g id="cluster_context"><path d="M8.5,387.2656 L62.5,387.2656 A3.75,3.75 0 0 1 65,389.7656 L72,409.7539 L598.5,409.7539 A2.5,2.5 0 0 1 601,412.2539 L601,582.7656 A2.5,2.5 0 0 1 598.5,585.2656 L8.5,585.2656 A2.5,2.5 0 0 1 6,582.7656 L6,389.7656 A2.5,2.5 0 0 1 8.5,387.2656 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="72" y1="409.7539" y2="409.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="53" x="10" y="402.8008">context</text></g><!--MD5=[df81d8a983ce68ee9869115533ee282f]
cluster authorization--><g id="cluster_authorization"><path d="M74.5,627.2656 L172.5,627.2656 A3.75,3.75 0 0 1 175,629.7656 L182,649.7539 L745.5,649.7539 A2.5,2.5 0 0 1 748,652.2539 L748,756.7656 A2.5,2.5 0 0 1 745.5,759.2656 L74.5,759.2656 A2.5,2.5 0 0 1 72,756.7656 L72,629.7656 A2.5,2.5 0 0 1 74.5,627.2656 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="72" x2="182" y1="649.7539" y2="649.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="97" x="76" y="642.8008">authorization</text></g><!--MD5=[9866a4850b67e61c0bb8154df9df1072]
cluster authentication--><g id="cluster_authentication"><path d="M1270.5,246.2656 L1375.5,246.2656 A3.75,3.75 0 0 1 1378,248.7656 L1385,268.7539 L1904.5,268.7539 A2.5,2.5 0 0 1 1907,271.2539 L1907,582.7656 A2.5,2.5 0 0 1 1904.5,585.2656 L1270.5,585.2656 A2.5,2.5 0 0 1 1268,582.7656 L1268,248.7656 A2.5,2.5 0 0 1 1270.5,246.2656 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1268" x2="1385" y1="268.7539" y2="268.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="104" x="1272" y="261.8008">authentication</text></g><!--MD5=[a8904d412b6bac905c960d0a15a57f60]
class Tenant--><g id="elem_Tenant"><rect codeLine="10" fill="#F1F1F1" height="80.9766" id="Tenant" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="167" x="380.5" y="99.2656"/><ellipse cx="435.75" cy="115.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M431.6777,111.0308 L431.6777,108.8726 L439.0571,108.8726 L439.0571,111.0308 L436.5918,111.0308 L436.5918,119.1074 L439.0571,119.1074 L439.0571,121.2656 L431.6777,121.2656 L431.6777,119.1074 L434.1431,119.1074 L434.1431,111.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="48" x="456.25" y="120.5566">Tenant</text><line style="stroke:#181818;stroke-width:0.5;" x1="381.5" x2="546.5" y1="131.2656" y2="131.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="386.5" y="148.8008">val tenantId: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155" x="386.5" y="165.2891">val isPlatform: Boolean</text><line style="stroke:#181818;stroke-width:0.5;" x1="381.5" x2="546.5" y1="172.2422" y2="172.2422"/></g><!--MD5=[2ee7de80ccb219b57973144fcb0a9e81]
class TenantCapable--><g id="elem_TenantCapable"><rect codeLine="14" fill="#F1F1F1" height="64.4883" id="TenantCapable" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136" x="396" y="273.2656"/><ellipse cx="411" cy="289.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M406.9277,285.0308 L406.9277,282.8726 L414.3071,282.8726 L414.3071,285.0308 L411.8418,285.0308 L411.8418,293.1074 L414.3071,293.1074 L414.3071,295.2656 L406.9277,295.2656 L406.9277,293.1074 L409.3931,293.1074 L409.3931,285.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="104" x="425" y="294.5566">TenantCapable</text><line style="stroke:#181818;stroke-width:0.5;" x1="397" x2="531" y1="305.2656" y2="305.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123" x="402" y="322.8008">val tenant: Tenant</text><line style="stroke:#181818;stroke-width:0.5;" x1="397" x2="531" y1="329.7539" y2="329.7539"/></g><path d="M152.5,122.2656 L152.5,147.5762 A0,0 0 0 0 152.5,147.5762 L345.5,147.5762 A0,0 0 0 0 345.5,147.5762 L345.5,140.2656 L384.5,159.998 L345.5,132.2656 L345.5,132.2656 L335.5,122.2656 L152.5,122.2656 A0,0 0 0 0 152.5,122.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M335.5,122.2656 L335.5,132.2656 L345.5,132.2656 L335.5,122.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="158.5" y="139.834">Is it a root platform tenant?</text><!--MD5=[891844a5ce18d50d477bdacc29a03b64]
class PolicyType--><g id="elem_PolicyType"><rect codeLine="26" fill="#F1F1F1" height="97.4648" id="PolicyType" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="2674" y="447.2656"/><ellipse cx="2689" cy="463.2656" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2693.1143,469.2656 L2685.3945,469.2656 L2685.3945,456.8726 L2693.1143,456.8726 L2693.1143,459.0308 L2687.8433,459.0308 L2687.8433,461.7036 L2692.6162,461.7036 L2692.6162,463.8618 L2687.8433,463.8618 L2687.8433,467.1074 L2693.1143,467.1074 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="2703" y="468.5566">PolicyType</text><line style="stroke:#181818;stroke-width:0.5;" x1="2675" x2="2777" y1="479.2656" y2="479.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="2680" y="496.8008">SYSTEM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="2680" y="513.2891">CUSTOM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="2680" y="529.7773">GLOBAL</text><line style="stroke:#181818;stroke-width:0.5;" x1="2675" x2="2777" y1="536.7305" y2="536.7305"/></g><!--MD5=[9445d644bbe92584b3fa45e77778917b]
class Policy--><g id="elem_Policy"><rect codeLine="31" fill="#F1F1F1" height="146.9297" id="Policy" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="230" x="2497" y="629.2656"/><ellipse cx="2588.25" cy="645.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2584.1777,641.0308 L2584.1777,638.8726 L2591.5571,638.8726 L2591.5571,641.0308 L2589.0918,641.0308 L2589.0918,649.1074 L2591.5571,649.1074 L2591.5571,651.2656 L2584.1777,651.2656 L2584.1777,649.1074 L2586.6431,649.1074 L2586.6431,641.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="39" x="2608.75" y="650.5566">Policy</text><line style="stroke:#181818;stroke-width:0.5;" x1="2498" x2="2726" y1="661.2656" y2="661.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="2503" y="678.8008">val id: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="2503" y="695.2891">val name: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132" x="2503" y="711.7773">val type: PolicyType</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="2503" y="728.2656">val description: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="2503" y="744.7539">val tenantId:String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="218" x="2503" y="761.2422">val statements: Set&lt;Statement&gt;</text><line style="stroke:#181818;stroke-width:0.5;" x1="2498" x2="2726" y1="768.1953" y2="768.1953"/></g><!--MD5=[354ba6fe2710e9f7c691253c66156a32]
class Effect--><g id="elem_Effect"><rect codeLine="39" fill="#F1F1F1" height="80.9766" id="Effect" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="2349" y="264.7656"/><ellipse cx="2364" cy="280.7656" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2368.1143,286.7656 L2360.3945,286.7656 L2360.3945,274.3726 L2368.1143,274.3726 L2368.1143,276.5308 L2362.8433,276.5308 L2362.8433,279.2036 L2367.6162,279.2036 L2367.6162,281.3618 L2362.8433,281.3618 L2362.8433,284.6074 L2368.1143,284.6074 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="2378" y="286.0566">Effect</text><line style="stroke:#181818;stroke-width:0.5;" x1="2350" x2="2418" y1="296.7656" y2="296.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="2355" y="314.3008">ALLOW</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="2355" y="330.7891">DENY</text><line style="stroke:#181818;stroke-width:0.5;" x1="2350" x2="2418" y1="337.7422" y2="337.7422"/></g><!--MD5=[dd3a6102b68975fd8f1a6314072b340a]
class RequestMatcher--><g id="elem_RequestMatcher"><rect codeLine="43" fill="#F1F1F1" height="64.4883" id="RequestMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="295" x="2665.5" y="107.7656"/><ellipse cx="2753.75" cy="123.7656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2749.6777,119.5308 L2749.6777,117.3726 L2757.0571,117.3726 L2757.0571,119.5308 L2754.5918,119.5308 L2754.5918,127.6074 L2757.0571,127.6074 L2757.0571,129.7656 L2749.6777,129.7656 L2749.6777,127.6074 L2752.1431,127.6074 L2752.1431,119.5308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="110" x="2774.25" y="129.0566">RequestMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="2666.5" x2="2959.5" y1="139.7656" y2="139.7656"/><line style="stroke:#181818;stroke-width:0.5;" x1="2666.5" x2="2959.5" y1="147.7656" y2="147.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="283" x="2671.5" y="165.3008">match(Request,SecurityContext): Boolean</text></g><!--MD5=[226a4eef5279541003c62db16c270ea5]
class ActionMatcher--><g id="elem_ActionMatcher"><rect codeLine="46" fill="#F1F1F1" height="48" id="ActionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131" x="2182.5" y="281.2656"/><ellipse cx="2197.5" cy="297.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2193.4277,293.0308 L2193.4277,290.8726 L2200.8071,290.8726 L2200.8071,293.0308 L2198.3418,293.0308 L2198.3418,301.1074 L2200.8071,301.1074 L2200.8071,303.2656 L2193.4277,303.2656 L2193.4277,301.1074 L2195.8931,301.1074 L2195.8931,293.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="99" x="2211.5" y="302.5566">ActionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="2183.5" x2="2312.5" y1="313.2656" y2="313.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="2183.5" x2="2312.5" y1="321.2656" y2="321.2656"/></g><!--MD5=[ce15d4ae5e7b4627c02fd240cc319742]
class ConditionMatcher--><g id="elem_ConditionMatcher"><rect codeLine="47" fill="#F1F1F1" height="48" id="ConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="155" x="2805.5" y="281.2656"/><ellipse cx="2820.5" cy="297.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2816.4277,293.0308 L2816.4277,290.8726 L2823.8071,290.8726 L2823.8071,293.0308 L2821.3418,293.0308 L2821.3418,301.1074 L2823.8071,301.1074 L2823.8071,303.2656 L2816.4277,303.2656 L2816.4277,301.1074 L2818.8931,301.1074 L2818.8931,293.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="123" x="2834.5" y="302.5566">ConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="2806.5" x2="2959.5" y1="313.2656" y2="313.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="2806.5" x2="2959.5" y1="321.2656" y2="321.2656"/></g><!--MD5=[a5f8f54a8c595155ff6d10bcb2300aea]
class VerifyResult--><g id="elem_VerifyResult"><rect codeLine="48" fill="#F1F1F1" height="97.4648" id="VerifyResult" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115" x="2515.5" y="91.2656"/><ellipse cx="2531.4" cy="107.2656" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2535.5143,113.2656 L2527.7945,113.2656 L2527.7945,100.8726 L2535.5143,100.8726 L2535.5143,103.0308 L2530.2433,103.0308 L2530.2433,105.7036 L2535.0162,105.7036 L2535.0162,107.8618 L2530.2433,107.8618 L2530.2433,111.1074 L2535.5143,111.1074 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="2545.6" y="112.5566">VerifyResult</text><line style="stroke:#181818;stroke-width:0.5;" x1="2516.5" x2="2629.5" y1="123.2656" y2="123.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="2521.5" y="140.8008">ALLOW</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="2521.5" y="157.2891">EXPLICIT_DENY</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="2521.5" y="173.7773">IMPLICIT_DENY</text><line style="stroke:#181818;stroke-width:0.5;" x1="2516.5" x2="2629.5" y1="180.7305" y2="180.7305"/></g><!--MD5=[a61a298976b7d1d94498f45c2ebfa10b]
class Statement--><g id="elem_Statement"><rect codeLine="53" fill="#F1F1F1" height="97.4648" id="Statement" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="281" x="2357.5" y="447.2656"/><ellipse cx="2459.25" cy="463.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2455.1777,459.0308 L2455.1777,456.8726 L2462.5571,456.8726 L2462.5571,459.0308 L2460.0918,459.0308 L2460.0918,467.1074 L2462.5571,467.1074 L2462.5571,469.2656 L2455.1777,469.2656 L2455.1777,467.1074 L2457.6431,467.1074 L2457.6431,459.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="69" x="2479.75" y="468.5566">Statement</text><line style="stroke:#181818;stroke-width:0.5;" x1="2358.5" x2="2637.5" y1="479.2656" y2="479.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="2363.5" y="496.8008">val effect: Effect</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222" x="2363.5" y="513.2891">val actions: Set&lt;ActionMatcher&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="269" x="2363.5" y="529.7773">val conditions: Set&lt;ConditionMatcher&gt;</text><line style="stroke:#181818;stroke-width:0.5;" x1="2358.5" x2="2637.5" y1="536.7305" y2="536.7305"/></g><!--MD5=[25907446179e7e8284c1a5a6eb221e77]
class PermissionVerifier--><g id="elem_PermissionVerifier"><rect codeLine="59" fill="#F1F1F1" height="64.4883" id="PermissionVerifier" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="316" x="2454" y="273.2656"/><ellipse cx="2545.25" cy="289.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2541.1777,285.0308 L2541.1777,282.8726 L2548.5571,282.8726 L2548.5571,285.0308 L2546.0918,285.0308 L2546.0918,293.1074 L2548.5571,293.1074 L2548.5571,295.2656 L2541.1777,295.2656 L2541.1777,293.1074 L2543.6431,293.1074 L2543.6431,285.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="125" x="2565.75" y="294.5566">PermissionVerifier</text><line style="stroke:#181818;stroke-width:0.5;" x1="2455" x2="2769" y1="305.2656" y2="305.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="2455" x2="2769" y1="313.2656" y2="313.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="304" x="2460" y="330.8008">verify(Request,SecurityContext): VerifyResult</text></g><!--MD5=[4a8e06406f0c0425d99e01150b1292e5]
class PolicyEvaluator--><g id="elem_PolicyEvaluator"><rect codeLine="62" fill="#F1F1F1" height="64.4883" id="PolicyEvaluator" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="135" x="2012.5" y="273.2656"/><ellipse cx="2027.5" cy="289.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2023.4277,285.0308 L2023.4277,282.8726 L2030.8071,282.8726 L2030.8071,285.0308 L2028.3418,285.0308 L2028.3418,293.1074 L2030.8071,293.1074 L2030.8071,295.2656 L2023.4277,295.2656 L2023.4277,293.1074 L2025.8931,293.1074 L2025.8931,285.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="103" x="2041.5" y="294.5566">PolicyEvaluator</text><line style="stroke:#181818;stroke-width:0.5;" x1="2013.5" x2="2146.5" y1="305.2656" y2="305.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="2013.5" x2="2146.5" y1="313.2656" y2="313.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="2018.5" y="330.8008">evaluate(Policy)</text></g><!--MD5=[79431584796416a68bc6cb91e9d847cd]
class PolicyCapable--><g id="elem_PolicyCapable"><rect codeLine="65" fill="#F1F1F1" height="64.4883" id="PolicyCapable" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="179" x="1947.5" y="107.7656"/><ellipse cx="1985.9" cy="123.7656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1981.8277,119.5308 L1981.8277,117.3726 L1989.2071,117.3726 L1989.2071,119.5308 L1986.7418,119.5308 L1986.7418,127.6074 L1989.2071,127.6074 L1989.2071,129.7656 L1981.8277,129.7656 L1981.8277,127.6074 L1984.2931,127.6074 L1984.2931,119.5308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="95" x="2005.1" y="129.0566">PolicyCapable</text><line style="stroke:#181818;stroke-width:0.5;" x1="1948.5" x2="2125.5" y1="139.7656" y2="139.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="167" x="1953.5" y="157.3008">val policies: Set&lt;String&gt;</text><line style="stroke:#181818;stroke-width:0.5;" x1="1948.5" x2="2125.5" y1="164.2539" y2="164.2539"/></g><g id="elem_GMN29"><path d="M2162,127.2656 L2162,152.5762 L2480,152.5762 L2480,137.2656 L2470,127.2656 L2162,127.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2470,127.2656 L2470,137.2656 L2480,137.2656 L2470,127.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297" x="2168" y="144.834">Used to evaluate the effectiveness of the Policy</text></g><!--MD5=[52681581877b3e7248987c87e027ce58]
class RoleCapable--><g id="elem_RoleCapable"><rect codeLine="86" fill="#F1F1F1" height="64.4883" id="RoleCapable" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="161" x="926.5" y="273.2656"/><ellipse cx="960.85" cy="289.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M956.7777,285.0308 L956.7777,282.8726 L964.1571,282.8726 L964.1571,285.0308 L961.6918,285.0308 L961.6918,293.1074 L964.1571,293.1074 L964.1571,295.2656 L956.7777,295.2656 L956.7777,293.1074 L959.2431,293.1074 L959.2431,285.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="86" x="979.15" y="294.5566">RoleCapable</text><line style="stroke:#181818;stroke-width:0.5;" x1="927.5" x2="1086.5" y1="305.2656" y2="305.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="932.5" y="322.8008">val roles: Set&lt;String&gt;</text><line style="stroke:#181818;stroke-width:0.5;" x1="927.5" x2="1086.5" y1="329.7539" y2="329.7539"/></g><!--MD5=[05e3ec1b6d12f04f2c7c7eb2dc3e534b]
class CoSecPrincipal--><g id="elem_CoSecPrincipal"><rect codeLine="89" fill="#F1F1F1" height="113.9531" id="CoSecPrincipal" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="250" x="641" y="248.2656"/><ellipse cx="711.25" cy="264.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M707.1777,260.0308 L707.1777,257.8726 L714.5571,257.8726 L714.5571,260.0308 L712.0918,260.0308 L712.0918,268.1074 L714.5571,268.1074 L714.5571,270.2656 L707.1777,270.2656 L707.1777,268.1074 L709.6431,268.1074 L709.6431,260.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="101" x="731.75" y="269.5566">CoSecPrincipal</text><line style="stroke:#181818;stroke-width:0.5;" x1="642" x2="890" y1="280.2656" y2="280.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="647" y="297.8008">val id: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="238" x="647" y="314.2891">val attributes: Map&lt;String, String&gt;</text><line style="stroke:#181818;stroke-width:0.5;" x1="642" x2="890" y1="321.2422" y2="321.2422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="153" x="647" y="338.7773">anonymous(): Boolean</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="167" x="647" y="355.2656">authenticated(): Boolean</text></g><!--MD5=[dcd1c42ae96b3f450c53e1d5a4b38ac2]
class TenantPrincipal--><g id="elem_TenantPrincipal"><rect codeLine="95" fill="#F1F1F1" height="48" id="TenantPrincipal" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="696.5" y="471.7656"/><ellipse cx="711.5" cy="487.7656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M707.4277,483.5308 L707.4277,481.3726 L714.8071,481.3726 L714.8071,483.5308 L712.3418,483.5308 L712.3418,491.6074 L714.8071,491.6074 L714.8071,493.7656 L707.4277,493.7656 L707.4277,491.6074 L709.8931,491.6074 L709.8931,483.5308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="107" x="725.5" y="493.0566">TenantPrincipal</text><line style="stroke:#181818;stroke-width:0.5;" x1="697.5" x2="834.5" y1="503.7656" y2="503.7656"/><line style="stroke:#181818;stroke-width:0.5;" x1="697.5" x2="834.5" y1="511.7656" y2="511.7656"/></g><path d="M1122.5,287.7656 L1122.5,296.4209 L1081.5,317.5098 L1122.5,304.4209 L1122.5,313.0762 A0,0 0 0 0 1122.5,313.0762 L1227.5,313.0762 A0,0 0 0 0 1227.5,313.0762 L1227.5,297.7656 L1217.5,287.7656 L1122.5,287.7656 A0,0 0 0 0 1122.5,287.7656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1217.5,287.7656 L1217.5,297.7656 L1227.5,297.7656 L1217.5,287.7656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="1128.5" y="305.334">A set of roles</text><!--MD5=[e2dc22e8225a918eadd77002df418415]
class java.security.Principal--><g id="elem_java.security.Principal"><rect codeLine="83" fill="#F1F1F1" height="64.4883" id="java.security.Principal" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="128" x="776" y="107.7656"/><ellipse cx="807.65" cy="123.7656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M803.5777,119.5308 L803.5777,117.3726 L810.9571,117.3726 L810.9571,119.5308 L808.4918,119.5308 L808.4918,127.6074 L810.9571,127.6074 L810.9571,129.7656 L803.5777,129.7656 L803.5777,127.6074 L806.0431,127.6074 L806.0431,119.5308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="59" x="825.35" y="129.0566">Principal</text><line style="stroke:#181818;stroke-width:0.5;" x1="777" x2="903" y1="139.7656" y2="139.7656"/><line style="stroke:#181818;stroke-width:0.5;" x1="777" x2="903" y1="147.7656" y2="147.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="782" y="165.3008">getName():String</text></g><!--MD5=[86b30c3e0fe779331a576db045bd0856]
class SecurityContext--><g id="elem_SecurityContext"><rect codeLine="108" fill="#F1F1F1" height="113.9531" id="SecurityContext" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="313" x="271.5" y="438.7656"/><ellipse cx="369.25" cy="454.7656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M365.1777,450.5308 L365.1777,448.3726 L372.5571,448.3726 L372.5571,450.5308 L370.0918,450.5308 L370.0918,458.6074 L372.5571,458.6074 L372.5571,460.7656 L365.1777,460.7656 L365.1777,458.6074 L367.6431,458.6074 L367.6431,450.5308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="109" x="389.75" y="460.0566">SecurityContext</text><line style="stroke:#181818;stroke-width:0.5;" x1="272.5" x2="583.5" y1="470.7656" y2="470.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="192" x="277.5" y="488.3008">val principal: CoSecPrincipal</text><line style="stroke:#181818;stroke-width:0.5;" x1="272.5" x2="583.5" y1="495.2539" y2="495.2539"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="301" x="277.5" y="512.7891">setAttribute(String, Object): SecurityContext</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="157" x="277.5" y="529.2773">getAttribute(String): T?</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="213" x="277.5" y="545.7656">getRequiredAttribute(String): T</text></g><!--MD5=[0851f84a889f989e7bb0bebc385d0f09]
class Request--><g id="elem_Request"><rect codeLine="117" fill="#F1F1F1" height="146.9297" id="Request" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="214" x="22" y="422.2656"/><ellipse cx="97.25" cy="438.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M93.1777,434.0308 L93.1777,431.8726 L100.5571,431.8726 L100.5571,434.0308 L98.0918,434.0308 L98.0918,442.1074 L100.5571,442.1074 L100.5571,444.2656 L93.1777,444.2656 L93.1777,442.1074 L95.6431,442.1074 L95.6431,434.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="55" x="117.75" y="443.5566">Request</text><line style="stroke:#181818;stroke-width:0.5;" x1="23" x2="235" y1="454.2656" y2="454.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="28" y="471.8008">val path: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="28" y="488.2891">val method: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="28" y="504.7773">val remoteIp: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="28" y="521.2656">val origin: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="28" y="537.7539">val referer: String</text><line style="stroke:#181818;stroke-width:0.5;" x1="23" x2="235" y1="544.707" y2="544.707"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="202" x="28" y="562.2422">getHeader(key: String): String</text></g><!--MD5=[eaab7d2ddd4405c2c7244fd25dd0c172]
class AuthorizeResult--><g id="elem_AuthorizeResult"><rect codeLine="128" fill="#F1F1F1" height="80.9766" id="AuthorizeResult" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="173" x="558.5" y="662.2656"/><ellipse cx="587.45" cy="678.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M583.3777,674.0308 L583.3777,671.8726 L590.7571,671.8726 L590.7571,674.0308 L588.2918,674.0308 L588.2918,682.1074 L590.7571,682.1074 L590.7571,684.2656 L583.3777,684.2656 L583.3777,682.1074 L585.8431,682.1074 L585.8431,674.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="110" x="604.55" y="683.5566">AuthorizeResult</text><line style="stroke:#181818;stroke-width:0.5;" x1="559.5" x2="730.5" y1="694.2656" y2="694.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="564.5" y="711.8008">val authorized: Boolean</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="564.5" y="728.2891">val reason: String</text><line style="stroke:#181818;stroke-width:0.5;" x1="559.5" x2="730.5" y1="735.2422" y2="735.2422"/></g><!--MD5=[16baea6be49bb9991e615d76903392b3]
class Authorization--><g id="elem_Authorization"><rect codeLine="132" fill="#F1F1F1" height="64.4883" id="Authorization" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="435" x="88.5" y="670.7656"/><ellipse cx="254.25" cy="686.7656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M250.1777,682.5308 L250.1777,680.3726 L257.5571,680.3726 L257.5571,682.5308 L255.0918,682.5308 L255.0918,690.6074 L257.5571,690.6074 L257.5571,692.7656 L250.1777,692.7656 L250.1777,690.6074 L252.6431,690.6074 L252.6431,682.5308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="95" x="274.75" y="692.0566">Authorization</text><line style="stroke:#181818;stroke-width:0.5;" x1="89.5" x2="522.5" y1="702.7656" y2="702.7656"/><line style="stroke:#181818;stroke-width:0.5;" x1="89.5" x2="522.5" y1="710.7656" y2="710.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="423" x="94.5" y="728.3008">authorize(Request,SecurityContext): Mono&lt;AuthorizeResult&gt;</text></g><!--MD5=[63e7a34560323ddebc94de26bb3dfe24]
class Credentials--><g id="elem_Credentials"><rect codeLine="140" fill="#F1F1F1" height="48" id="Credentials" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="1385" y="281.2656"/><ellipse cx="1400" cy="297.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1395.9277,293.0308 L1395.9277,290.8726 L1403.3071,290.8726 L1403.3071,293.0308 L1400.8418,293.0308 L1400.8418,301.1074 L1403.3071,301.1074 L1403.3071,303.2656 L1395.9277,303.2656 L1395.9277,301.1074 L1398.3931,301.1074 L1398.3931,293.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="78" x="1414" y="302.5566">Credentials</text><line style="stroke:#181818;stroke-width:0.5;" x1="1386" x2="1494" y1="313.2656" y2="313.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="1386" x2="1494" y1="321.2656" y2="321.2656"/></g><!--MD5=[a139e992f8a77546bf37c14edd197f06]
class Authentication--><g id="elem_Authentication"><rect codeLine="141" fill="#F1F1F1" height="80.9766" id="Authentication" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="312" x="1284" y="455.2656"/><ellipse cx="1299" cy="471.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1294.9277,467.0308 L1294.9277,464.8726 L1302.3071,464.8726 L1302.3071,467.0308 L1299.8418,467.0308 L1299.8418,475.1074 L1302.3071,475.1074 L1302.3071,477.2656 L1294.9277,477.2656 L1294.9277,475.1074 L1297.3931,475.1074 L1297.3931,467.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="101" x="1313" y="476.5566">Authentication</text><rect fill="#FFFFFF" height="16.1328" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="177" x="1422" y="452.2656"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="175" x="1423" y="464.8672">C:Credentials,P:CoSecPrincipal</text><line style="stroke:#181818;stroke-width:0.5;" x1="1285" x2="1595" y1="487.2656" y2="487.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="208" x="1290" y="504.8008">supportCredentials: Class&lt;C&gt;</text><line style="stroke:#181818;stroke-width:0.5;" x1="1285" x2="1595" y1="511.7539" y2="511.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="182" x="1290" y="529.2891">authenticate(C): Mono&lt;P&gt;</text></g><!--MD5=[f074fdee743888442a4f97901e556f9c]
class AuthenticationProvider--><g id="elem_AuthenticationProvider"><rect codeLine="145" fill="#F1F1F1" height="146.9297" id="AuthenticationProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="260" x="1631" y="422.2656"/><ellipse cx="1677.75" cy="438.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1673.6777,434.0308 L1673.6777,431.8726 L1681.0571,431.8726 L1681.0571,434.0308 L1678.5918,434.0308 L1678.5918,442.1074 L1681.0571,442.1074 L1681.0571,444.2656 L1673.6777,444.2656 L1673.6777,442.1074 L1676.1431,442.1074 L1676.1431,434.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="158" x="1698.25" y="443.5566">AuthenticationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1632" x2="1890" y1="454.2656" y2="454.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="1632" x2="1890" y1="462.2656" y2="462.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="192" x="1637" y="479.8008">get(Class&lt;Credentials&gt;): A?</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="248" x="1637" y="496.2891">getRequired(Class&lt;Credentials&gt;): A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="1637" y="512.7773">register(A): Unit</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185" x="1637" y="529.2656">register(Class&lt;C&gt;, A): Unit</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="1637" y="545.7539">register(A): Unit</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="248" x="1637" y="562.2422">getRequired(Class&lt;Credentials&gt;): A</text></g><!--MD5=[7c5c88a606935469d5f89b0b5794816c]
class Named--><g id="elem_Named"><rect codeLine="5" fill="#F1F1F1" height="64.4883" id="Named" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="641.5" y="107.7656"/><ellipse cx="665.05" cy="123.7656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M660.9777,119.5308 L660.9777,117.3726 L668.3571,117.3726 L668.3571,119.5308 L665.8918,119.5308 L665.8918,127.6074 L668.3571,127.6074 L668.3571,129.7656 L660.9777,129.7656 L660.9777,127.6074 L663.4431,127.6074 L663.4431,119.5308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="48" x="680.95" y="129.0566">Named</text><line style="stroke:#181818;stroke-width:0.5;" x1="642.5" x2="739.5" y1="139.7656" y2="139.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="647.5" y="157.3008">name: String</text><line style="stroke:#181818;stroke-width:0.5;" x1="642.5" x2="739.5" y1="164.2539" y2="164.2539"/></g><!--MD5=[d3fc1cb30f7bdcc9e19e497f9b6ed3e8]
link Tenant to TenantCapable--><g id="link_Tenant_TenantCapable"><path codeLine="18" d="M464,195.0056 C464,215.6056 464,259.3556 464,259.3556 " fill="none" id="Tenant-TenantCapable" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="464,182.2756,460,191.2756,464,187.2756,468,191.2756,464,182.2756" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="464" x2="464" y1="187.2756" y2="195.2756"/><polygon fill="#181818" points="464,271.3556,468,265.3556,464,259.3556,460,265.3556,464,271.3556" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[3a61d607afa5f9046415286ff45a7e54]
reverse link RequestMatcher to ActionMatcher--><g id="link_RequestMatcher_ActionMatcher"><path codeLine="68" d="M2714.32,178.8456 C2692.76,185.6956 2669.85,191.8856 2648,195.7656 C2613.42,201.9156 2363.65,190.0256 2332,205.2656 C2298.89,221.2056 2273.89,256.9756 2260.1,280.8756 " fill="none" id="RequestMatcher-backto-ActionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2711.86,172.2856,2733.05,172.6056,2716.29,185.5656,2711.86,172.2856" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[bdb7cf9e45c1a2c85396bf792a7d7532]
reverse link RequestMatcher to ConditionMatcher--><g id="link_RequestMatcher_ConditionMatcher"><path codeLine="69" d="M2834.64,191.3156 C2847.44,221.2056 2863.04,257.6556 2873,280.9056 " fill="none" id="RequestMatcher-backto-ConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2828.36,194.4356,2826.93,173.2956,2841.23,188.9256,2828.36,194.4356" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[99bd1ab024ee26fc6b7c63d9677fdb72]
reverse link PermissionVerifier to Statement--><g id="link_PermissionVerifier_Statement"><path codeLine="70" d="M2582.15,355.6256 C2565.09,383.8256 2543.8,419.0256 2526.91,446.9656 " fill="none" id="PermissionVerifier-backto-Statement" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2576.05,352.1756,2592.39,338.6856,2588.03,359.4256,2576.05,352.1756" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e4eaaab51f62ef0fd17f62ea5476519c]
link Effect to Statement--><g id="link_Effect_Statement"><path codeLine="71" d="M2415.57,358.4756 C2429.88,382.1256 2462.0154,435.2702 2462.0154,435.2702 " fill="none" id="Effect-Statement" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2408.96,347.5356,2410.1936,357.3069,2411.547,351.8143,2417.0396,353.1677,2408.96,347.5356" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2411.547" x2="2415.685" y1="351.8143" y2="358.6606"/><polygon fill="#181818" points="2468.23,445.5356,2468.5445,438.3314,2462.0154,435.2702,2461.7009,442.4745,2468.23,445.5356" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[421c707edf9dcb67c653879c9588b357]
link ActionMatcher to Statement--><g id="link_ActionMatcher_Statement"><path codeLine="72" d="M2290.74,338.4956 C2326.99,365.8256 2423.6574,438.7124 2423.6574,438.7124 " fill="none" id="ActionMatcher-Statement" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2280.37,330.6656,2285.1435,339.2804,2284.3607,333.6779,2289.9632,332.8952,2280.37,330.6656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2284.3607" x2="2290.75" y1="333.6779" y2="338.4956"/><polygon fill="#181818" points="2433.24,445.9356,2430.8564,439.1298,2423.6574,438.7124,2426.041,445.5182,2433.24,445.9356" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[04f4abb29adabcf38a547a8eb9430c3b]
link ConditionMatcher to Statement--><g id="link_ConditionMatcher_Statement"><path codeLine="73" d="M2838.93,337.2456 C2823.48,346.7256 2805.57,356.2256 2788,362.2656 C2732.47,381.3356 2711.55,357.5656 2657,379.2656 C2622.45,393.0156 2560.3726,438.2699 2560.3726,438.2699 " fill="none" id="ConditionMatcher-Statement" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2849.48,330.5256,2839.7408,331.9911,2845.264,333.2136,2844.0415,338.7367,2849.48,330.5256" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2845.264" x2="2838.515" y1="333.2136" y2="337.5106"/><polygon fill="#181818" points="2551.05,445.8256,2558.2299,445.1553,2560.3726,438.2699,2553.1928,438.9402,2551.05,445.8256" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e3680ece5eb6e2539ae6dce9363554de]
link PolicyType to Policy--><g id="link_PolicyType_Policy"><path codeLine="74" d="M2692.47,557.0556 C2682.15,575.6256 2659.0611,617.1276 2659.0611,617.1276 " fill="none" id="PolicyType-Policy" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2698.68,545.8956,2690.8107,551.8179,2696.2504,550.2656,2697.8027,555.7053,2698.68,545.8956" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2696.2504" x2="2692.365" y1="550.2656" y2="557.2556"/><polygon fill="#181818" points="2653.23,627.6156,2659.6415,624.3153,2659.0611,617.1276,2652.6495,620.4279,2653.23,627.6156" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a7b3af78aa4d03cb0e67dc6b5e1b33d1]
link Statement to Policy--><g id="link_Statement_Policy"><path codeLine="75" d="M2531.53,557.0556 C2541.85,575.6256 2564.9389,617.1276 2564.9389,617.1276 " fill="none" id="Statement-Policy" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2525.32,545.8956,2526.1973,555.7053,2527.7496,550.2656,2533.1893,551.8179,2525.32,545.8956" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2527.7496" x2="2531.635" y1="550.2656" y2="557.2556"/><polygon fill="#181818" points="2570.77,627.6156,2571.3505,620.4279,2564.9389,617.1276,2564.3585,624.3153,2570.77,627.6156" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f6501252c65be42b38a34c7ff3f78362]
link GMN29 to PolicyEvaluator--><g id="link_GMN29_PolicyEvaluator"><path d="M2277.52,152.6756 C2244.58,163.0856 2199.3,180.4256 2165,205.2656 C2139.31,223.8656 2116.3,251.7256 2100.72,273.1656 " fill="none" id="GMN29-PolicyEvaluator" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/></g><!--MD5=[017c10c76ce2d36bd60f0dc62a4a72a8]
reverse link java.security.Principal to CoSecPrincipal--><g id="link_java.security.Principal_CoSecPrincipal"><path codeLine="96" d="M817.12,191.3256 C808.98,209.3056 799.76,229.6656 791.42,248.0956 " fill="none" id="java.security.Principal-backto-CoSecPrincipal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="810.66,188.6156,825.28,173.2856,823.41,194.3856,810.66,188.6156" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[5b5054689bf2020954aca84a99bf32ab]
reverse link TenantCapable to TenantPrincipal--><g id="link_TenantCapable_TenantPrincipal"><path codeLine="97" d="M545.46,347.5856 C563.96,357.5456 583.35,368.4456 601,379.2656 C649.29,408.8856 702.54,447.2656 735.13,471.4656 " fill="none" id="TenantCapable-backto-TenantPrincipal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="542.34,353.8556,527.95,338.3056,548.9,341.4856,542.34,353.8556" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e7f6508ff043c461a5f165263bc71b5b]
reverse link CoSecPrincipal to TenantPrincipal--><g id="link_CoSecPrincipal_TenantPrincipal"><path codeLine="98" d="M766,383.8456 C766,415.4456 766,449.6256 766,471.5656 " fill="none" id="CoSecPrincipal-backto-TenantPrincipal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="759,384.0756,766,364.0756,773,384.0756,759,384.0756" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[c7c8313ddc0bad273885a8234da768c1]
reverse link Named to CoSecPrincipal--><g id="link_Named_CoSecPrincipal"><path codeLine="99" d="M714.19,191.3256 C722.44,209.3056 731.78,229.6656 740.23,248.0956 " fill="none" id="Named-backto-CoSecPrincipal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="707.89,194.3756,705.91,173.2756,720.62,188.5356,707.89,194.3756" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[903468ed3f54634ff2089a3230707525]
reverse link RoleCapable to TenantPrincipal--><g id="link_RoleCapable_TenantPrincipal"><path codeLine="100" d="M950.08,350.7856 C901.74,388.5956 834.27,441.3656 795.87,471.3956 " fill="none" id="RoleCapable-backto-TenantPrincipal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="945.67,345.3456,965.74,338.5356,954.3,356.3756,945.67,345.3456" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2e9dd4d24c620f4ef4c09958d90dc0d9]
reverse link PolicyCapable to CoSecPrincipal--><g id="link_PolicyCapable_CoSecPrincipal"><path codeLine="101" d="M1925.68,143.7056 C1659.89,151.2156 1003.32,172.8156 909,205.2656 C881.45,214.7456 854.35,231.1456 831.27,247.9056 " fill="none" id="PolicyCapable-backto-CoSecPrincipal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1925.45,136.7056,1945.63,143.1456,1925.84,150.7056,1925.45,136.7056" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[b1a9f71c494fe876e4b85e22ffb61b43]
reverse link TenantCapable to SecurityContext--><g id="link_TenantCapable_SecurityContext"><path codeLine="114" d="M454.09,358.1856 C449.33,383.0956 443.62,412.9856 438.76,438.4456 " fill="none" id="TenantCapable-backto-SecurityContext" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="447.14,357.2156,457.77,338.8756,460.9,359.8356,447.14,357.2156" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0c4cc86a4eab11f0ad45d9e81ff75b78]
link CoSecPrincipal to SecurityContext--><g id="link_CoSecPrincipal_SecurityContext"><path codeLine="115" d="M655.63,362.6956 C645.24,368.2256 634.9,373.8056 625,379.2656 C595.23,395.6856 563.3,414.0656 534,431.2456 " fill="none" id="CoSecPrincipal-to-SecurityContext" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="522.92,437.7556,530.1194,438.1665,533.2676,431.6789,526.0682,431.268,522.92,437.7556" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[30076c0053eee824d8d2442e12969676]
reverse link Request to Authorization--><g id="link_Request_Authorization"><path codeLine="135" d="M196.12,574.5056 C224.88,607.8156 256.84,644.8356 278.85,670.3156 " fill="none" id="Request-backto-Authorization" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="192.89,570.7656,195.7481,580.1907,196.1592,574.5488,201.8011,574.9599,192.89,570.7656" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[7ca05d895fd4d3e3cb6ad83c182c7856]
reverse link SecurityContext to Authorization--><g id="link_SecurityContext_Authorization"><path codeLine="136" d="M391.3,558.4356 C369.32,595.3656 342.31,640.7456 324.65,670.4256 " fill="none" id="SecurityContext-backto-Authorization" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="393.73,554.3556,385.6835,560.0348,391.1681,558.6494,392.5535,564.134,393.73,554.3556" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[6b6dcf69d22c7b7e80e54001a420a613]
reverse link CoSecPrincipal to Authentication--><g id="link_CoSecPrincipal_Authentication"><path codeLine="153" d="M897.38,359.5256 C901.27,360.5156 905.15,361.4356 909,362.2656 C1054.74,393.6356 1101.21,336.4056 1244,379.2656 C1296.96,395.1656 1350.61,428.2156 1388.36,454.9056 " fill="none" id="CoSecPrincipal-backto-Authentication" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="892.71,358.2856,900.3777,364.4667,897.5416,359.5722,902.4362,356.7361,892.71,358.2856" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[615981591744dbfd257bd758771ab80b]
reverse link Credentials to Authentication--><g id="link_Credentials_Authentication"><path codeLine="154" d="M1440,335.9056 C1440,367.9456 1440,419.2156 1440,454.8056 " fill="none" id="Credentials-backto-Authentication" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="1440,331.2756,1436,340.2756,1440,336.2756,1444,340.2756,1440,331.2756" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[40d5522495084d761aba8f9786b248b8]
link Authentication to AuthenticationProvider--><g id="link_Authentication_AuthenticationProvider"><path codeLine="155" d="M1610.93,495.7656 C1612.8,495.7656 1617.3,495.7656 1617.3,495.7656 " fill="none" id="Authentication-AuthenticationProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1597.94,495.7656,1606.94,499.7656,1602.94,495.7656,1606.94,491.7656,1597.94,495.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1602.94" x2="1610.94" y1="495.7656" y2="495.7656"/><polygon fill="#181818" points="1629.3,495.7656,1623.3,491.7656,1617.3,495.7656,1623.3,499.7656,1629.3,495.7656" style="stroke:#181818;stroke-width:1.0;"/></g><a href="https://github.com/Ahoo-Wang/CoSec" target="_top" title="https://github.com/Ahoo-Wang/CoSec" xlink:actuate="onRequest" xlink:href="https://github.com/Ahoo-Wang/CoSec" xlink:show="new" xlink:title="https://github.com/Ahoo-Wang/CoSec" xlink:type="simple"><text fill="#808080" font-family="sans-serif" font-size="10" lengthAdjust="spacing" text-decoration="underline" textLength="189" x="1390.5" y="807.9336">https://github.com/Ahoo-Wang/CoSec</text></a><!--MD5=[48f5b95d9c005b3b03a37183ca709b71]
@startuml
!include layout.puml

title CoSec Modeling Class Diagram

interface Named{
    name: String
}

package tenant{
    interface Tenant {
       val tenantId: String
       val isPlatform: Boolean
    }
    interface TenantCapable {
        val tenant: Tenant
    }

    Tenant <- -*  TenantCapable

    note left of Tenant::isPlatform
        Is it a root platform tenant?
    end note
}

package policy{
    enum PolicyType {
        SYSTEM
        CUSTOM
        GLOBAL
    }
    interface Policy {
        val id: String
        val name: String
        val type: PolicyType
        val description: String
        val tenantId:String
        val statements: Set<Statement>
    }
    enum Effect {
        ALLOW
        DENY
    }
    interface RequestMatcher {
        match(Request,SecurityContext): Boolean
    }
    interface ActionMatcher
    interface ConditionMatcher
    enum VerifyResult{
        ALLOW
        EXPLICIT_DENY
        IMPLICIT_DENY
    }
    interface Statement{
        val effect: Effect
        val actions: Set<ActionMatcher>
        val conditions: Set<ConditionMatcher>
    }

    interface PermissionVerifier {
        verify(Request,SecurityContext): VerifyResult
    }
    interface PolicyEvaluator {
        evaluate(Policy)
    }
    interface PolicyCapable {
        val policies: Set<String>
    }
    RequestMatcher <|- - ActionMatcher
    RequestMatcher <|- - ConditionMatcher
    PermissionVerifier <|- - Statement
    Effect <- -*  Statement
    ActionMatcher <- -*  Statement
    ConditionMatcher <- -*  Statement
    PolicyType <- -*  Policy
    Statement <- -*  Policy

    note top of PolicyEvaluator
        Used to evaluate the effectiveness of the Policy
    end note
}

package principal{
    interface java.security.Principal{
        getName():String
    }
    interface RoleCapable {
        val roles: Set<String>
    }
    interface CoSecPrincipal{
        val id: String
        val attributes: Map<String, String>
        anonymous(): Boolean
        authenticated(): Boolean
    }
    interface TenantPrincipal
    java.security.Principal <|- - CoSecPrincipal
    TenantCapable <|- - TenantPrincipal
    CoSecPrincipal <|- - TenantPrincipal
    Named <|- - CoSecPrincipal
    RoleCapable <|- - TenantPrincipal
    PolicyCapable <|- - CoSecPrincipal
    note right of RoleCapable::role
        A set of roles
    end note
}

package context{
    interface SecurityContext {
        val principal: CoSecPrincipal
        setAttribute(String, Object): SecurityContext
        getAttribute(String): T?
        getRequiredAttribute(String): T
    }
    TenantCapable <|- -  SecurityContext
    CoSecPrincipal - -* SecurityContext

    interface Request{
        val path: String
        val method: String
        val remoteIp: String
        val origin: String
        val referer: String
        getHeader(key: String): String
    }
}

package authorization{
    interface AuthorizeResult {
        val authorized: Boolean
        val reason: String
    }
    interface Authorization {
        authorize(Request,SecurityContext): Mono<AuthorizeResult>
    }
    Request <-[dashed]- Authorization
    SecurityContext <-[dashed]- Authorization
}

package authentication{
    interface Credentials
    interface Authentication<C:Credentials,P:CoSecPrincipal>{
       authenticate(C): Mono<P>
       supportCredentials: Class<C>
    }
    interface AuthenticationProvider{
       get(Class<Credentials>): A?
       getRequired(Class<Credentials>): A
       register(A): Unit
       register(Class<C>, A): Unit
       register(A): Unit
       getRequired(Class<Credentials>): A
    }
    CoSecPrincipal <-[dashed]- Authentication
    Credentials <-[dashed]- Authentication
    Authentication <-* AuthenticationProvider
}

@enduml

@startuml
skinparam hyperlinkColor grey


header
[[https://github.com/Ahoo-Wang/CoSec]]
endheader

center footer [[https://github.com/Ahoo-Wang/CoSec]]


title CoSec Modeling Class Diagram

interface Named{
    name: String
}

package tenant{
    interface Tenant {
       val tenantId: String
       val isPlatform: Boolean
    }
    interface TenantCapable {
        val tenant: Tenant
    }

    Tenant <- -*  TenantCapable

    note left of Tenant::isPlatform
        Is it a root platform tenant?
    end note
}

package policy{
    enum PolicyType {
        SYSTEM
        CUSTOM
        GLOBAL
    }
    interface Policy {
        val id: String
        val name: String
        val type: PolicyType
        val description: String
        val tenantId:String
        val statements: Set<Statement>
    }
    enum Effect {
        ALLOW
        DENY
    }
    interface RequestMatcher {
        match(Request,SecurityContext): Boolean
    }
    interface ActionMatcher
    interface ConditionMatcher
    enum VerifyResult{
        ALLOW
        EXPLICIT_DENY
        IMPLICIT_DENY
    }
    interface Statement{
        val effect: Effect
        val actions: Set<ActionMatcher>
        val conditions: Set<ConditionMatcher>
    }

    interface PermissionVerifier {
        verify(Request,SecurityContext): VerifyResult
    }
    interface PolicyEvaluator {
        evaluate(Policy)
    }
    interface PolicyCapable {
        val policies: Set<String>
    }
    RequestMatcher <|- - ActionMatcher
    RequestMatcher <|- - ConditionMatcher
    PermissionVerifier <|- - Statement
    Effect <- -*  Statement
    ActionMatcher <- -*  Statement
    ConditionMatcher <- -*  Statement
    PolicyType <- -*  Policy
    Statement <- -*  Policy

    note top of PolicyEvaluator
        Used to evaluate the effectiveness of the Policy
    end note
}

package principal{
    interface java.security.Principal{
        getName():String
    }
    interface RoleCapable {
        val roles: Set<String>
    }
    interface CoSecPrincipal{
        val id: String
        val attributes: Map<String, String>
        anonymous(): Boolean
        authenticated(): Boolean
    }
    interface TenantPrincipal
    java.security.Principal <|- - CoSecPrincipal
    TenantCapable <|- - TenantPrincipal
    CoSecPrincipal <|- - TenantPrincipal
    Named <|- - CoSecPrincipal
    RoleCapable <|- - TenantPrincipal
    PolicyCapable <|- - CoSecPrincipal
    note right of RoleCapable::role
        A set of roles
    end note
}

package context{
    interface SecurityContext {
        val principal: CoSecPrincipal
        setAttribute(String, Object): SecurityContext
        getAttribute(String): T?
        getRequiredAttribute(String): T
    }
    TenantCapable <|- -  SecurityContext
    CoSecPrincipal - -* SecurityContext

    interface Request{
        val path: String
        val method: String
        val remoteIp: String
        val origin: String
        val referer: String
        getHeader(key: String): String
    }
}

package authorization{
    interface AuthorizeResult {
        val authorized: Boolean
        val reason: String
    }
    interface Authorization {
        authorize(Request,SecurityContext): Mono<AuthorizeResult>
    }
    Request <-[dashed]- Authorization
    SecurityContext <-[dashed]- Authorization
}

package authentication{
    interface Credentials
    interface Authentication<C:Credentials,P:CoSecPrincipal>{
       authenticate(C): Mono<P>
       supportCredentials: Class<C>
    }
    interface AuthenticationProvider{
       get(Class<Credentials>): A?
       getRequired(Class<Credentials>): A
       register(A): Unit
       register(Class<C>, A): Unit
       register(A): Unit
       getRequired(Class<Credentials>): A
    }
    CoSecPrincipal <-[dashed]- Authentication
    Credentials <-[dashed]- Authentication
    Authentication <-* AuthenticationProvider
}

@enduml

PlantUML version 1.2022.13(Sat Nov 19 21:22:17 CST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>
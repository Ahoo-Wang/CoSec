<?xml version="1.0" encoding="UTF-8" standalone="no"?><!--
  - Copyright [2021-present] [ahoo wang <ahoowang@qq.com> (https://github.com/Ahoo-Wang)].
  - Licensed under the Apache License, Version 2.0 (the "License");
  - you may not use this file except in compliance with the License.
  - You may obtain a copy of the License at
  -      http://www.apache.org/licenses/LICENSE-2.0
  - Unless required by applicable law or agreed to in writing, software
  - distributed under the License is distributed on an "AS IS" BASIS,
  - WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  - See the License for the specific language governing permissions and
  - limitations under the License.
  -->

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="835px" preserveAspectRatio="none" style="width:2984px;height:835px;background:#FFFFFF;" version="1.1" viewBox="0 0 2984 835" width="2984px" zoomAndPan="magnify"><defs/><g><a href="https://github.com/Ahoo-Wang/CoSec" target="_top" title="https://github.com/Ahoo-Wang/CoSec" xlink:actuate="onRequest" xlink:href="https://github.com/Ahoo-Wang/CoSec" xlink:show="new" xlink:title="https://github.com/Ahoo-Wang/CoSec" xlink:type="simple"><text fill="#808080" font-family="sans-serif" font-size="10" lengthAdjust="spacing" text-decoration="underline" textLength="189" x="2781" y="9.668">https://github.com/Ahoo-Wang/CoSec</text></a><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="224" x="1373" y="36.3125">CoSec Modeling Class Diagram</text><!--MD5=[158ea172665500f9d1b87622b0f57e22]
cluster tenant--><g id="cluster_tenant"><path d="M102.5,56.2656 L149.5,56.2656 A3.75,3.75 0 0 1 152,58.7656 L159,78.7539 L573.5,78.7539 A2.5,2.5 0 0 1 576,81.2539 L576,367.7656 A2.5,2.5 0 0 1 573.5,370.2656 L102.5,370.2656 A2.5,2.5 0 0 1 100,367.7656 L100,58.7656 A2.5,2.5 0 0 1 102.5,56.2656 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="100" x2="159" y1="78.7539" y2="78.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="46" x="104" y="71.8008">tenant</text></g><!--MD5=[73372e1614ca5de955321ff74365eabf]
cluster policy--><g id="cluster_policy"><path d="M1933.5,64.7656 L1977.5,64.7656 A3.75,3.75 0 0 1 1980,67.2656 L1987,87.2539 L2974.5,87.2539 A2.5,2.5 0 0 1 2977,89.7539 L2977,806.7656 A2.5,2.5 0 0 1 2974.5,809.2656 L1933.5,809.2656 A2.5,2.5 0 0 1 1931,806.7656 L1931,67.2656 A2.5,2.5 0 0 1 1933.5,64.7656 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1931" x2="1987" y1="87.2539" y2="87.2539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="43" x="1935" y="80.3008">policy</text></g><!--MD5=[d119c4a9d5e0dd9c185bd0ddda62ab2d]
cluster principal--><g id="cluster_principal"><path d="M627.5,230.2656 L691.5,230.2656 A3.75,3.75 0 0 1 694,232.7656 L701,252.7539 L1241.5,252.7539 A2.5,2.5 0 0 1 1244,255.2539 L1244,550.2656 A2.5,2.5 0 0 1 1241.5,552.7656 L627.5,552.7656 A2.5,2.5 0 0 1 625,550.2656 L625,232.7656 A2.5,2.5 0 0 1 627.5,230.2656 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="625" x2="701" y1="252.7539" y2="252.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="63" x="629" y="245.8008">principal</text></g><!--MD5=[67892945c51b45dfa1cd11fc454571f7]
cluster java.security--><g id="cluster_java.security"><path d="M788.5,81.2656 L878.5,81.2656 A3.75,3.75 0 0 1 881,83.7656 L888,103.7539 L943.5,103.7539 A2.5,2.5 0 0 1 946,106.2539 L946,193.7656 A2.5,2.5 0 0 1 943.5,196.2656 L788.5,196.2656 A2.5,2.5 0 0 1 786,193.7656 L786,83.7656 A2.5,2.5 0 0 1 788.5,81.2656 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="786" x2="888" y1="103.7539" y2="103.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="89" x="790" y="96.8008">java.security</text></g><!--MD5=[7f1db14b27b7629509c802e44e13c9c4]
cluster context--><g id="cluster_context"><path d="M8.5,404.2656 L62.5,404.2656 A3.75,3.75 0 0 1 65,406.7656 L72,426.7539 L598.5,426.7539 A2.5,2.5 0 0 1 601,429.2539 L601,599.7656 A2.5,2.5 0 0 1 598.5,602.2656 L8.5,602.2656 A2.5,2.5 0 0 1 6,599.7656 L6,406.7656 A2.5,2.5 0 0 1 8.5,404.2656 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="72" y1="426.7539" y2="426.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="53" x="10" y="419.8008">context</text></g><!--MD5=[df81d8a983ce68ee9869115533ee282f]
cluster authorization--><g id="cluster_authorization"><path d="M74.5,644.2656 L172.5,644.2656 A3.75,3.75 0 0 1 175,646.7656 L182,666.7539 L745.5,666.7539 A2.5,2.5 0 0 1 748,669.2539 L748,773.7656 A2.5,2.5 0 0 1 745.5,776.2656 L74.5,776.2656 A2.5,2.5 0 0 1 72,773.7656 L72,646.7656 A2.5,2.5 0 0 1 74.5,644.2656 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="72" x2="182" y1="666.7539" y2="666.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="97" x="76" y="659.8008">authorization</text></g><!--MD5=[9866a4850b67e61c0bb8154df9df1072]
cluster authentication--><g id="cluster_authentication"><path d="M1270.5,263.2656 L1375.5,263.2656 A3.75,3.75 0 0 1 1378,265.7656 L1385,285.7539 L1904.5,285.7539 A2.5,2.5 0 0 1 1907,288.2539 L1907,599.7656 A2.5,2.5 0 0 1 1904.5,602.2656 L1270.5,602.2656 A2.5,2.5 0 0 1 1268,599.7656 L1268,265.7656 A2.5,2.5 0 0 1 1270.5,263.2656 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1268" x2="1385" y1="285.7539" y2="285.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="104" x="1272" y="278.8008">authentication</text></g><!--MD5=[a8904d412b6bac905c960d0a15a57f60]
class Tenant--><g id="elem_Tenant"><rect codeLine="10" fill="#F1F1F1" height="113.9531" id="Tenant" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="215" x="344.5" y="91.2656"/><ellipse cx="423.75" cy="107.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M419.6777,103.0308 L419.6777,100.8726 L427.0571,100.8726 L427.0571,103.0308 L424.5918,103.0308 L424.5918,111.1074 L427.0571,111.1074 L427.0571,113.2656 L419.6777,113.2656 L419.6777,111.1074 L422.1431,111.1074 L422.1431,103.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="48" x="444.25" y="112.5566">Tenant</text><line style="stroke:#181818;stroke-width:0.5;" x1="345.5" x2="558.5" y1="123.2656" y2="123.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="350.5" y="140.8008">val tenantId: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="203" x="350.5" y="157.2891">val isPlatformTenant: Boolean</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="194" x="350.5" y="173.7773">val isDefaultTenant: Boolean</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="176" x="350.5" y="190.2656">val isUserTenant: Boolean</text><line style="stroke:#181818;stroke-width:0.5;" x1="345.5" x2="558.5" y1="197.2188" y2="197.2188"/></g><!--MD5=[2ee7de80ccb219b57973144fcb0a9e81]
class TenantCapable--><g id="elem_TenantCapable"><rect codeLine="16" fill="#F1F1F1" height="64.4883" id="TenantCapable" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136" x="384" y="290.2656"/><ellipse cx="399" cy="306.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M394.9277,302.0308 L394.9277,299.8726 L402.3071,299.8726 L402.3071,302.0308 L399.8418,302.0308 L399.8418,310.1074 L402.3071,310.1074 L402.3071,312.2656 L394.9277,312.2656 L394.9277,310.1074 L397.3931,310.1074 L397.3931,302.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="104" x="413" y="311.5566">TenantCapable</text><line style="stroke:#181818;stroke-width:0.5;" x1="385" x2="519" y1="322.2656" y2="322.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123" x="390" y="339.8008">val tenant: Tenant</text><line style="stroke:#181818;stroke-width:0.5;" x1="385" x2="519" y1="346.7539" y2="346.7539"/></g><path d="M116.5,130.7656 L116.5,156.0762 A0,0 0 0 0 116.5,156.0762 L309.5,156.0762 A0,0 0 0 0 309.5,156.0762 L309.5,148.7656 L348.5,151.998 L309.5,140.7656 L309.5,140.7656 L299.5,130.7656 L116.5,130.7656 A0,0 0 0 0 116.5,130.7656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M299.5,130.7656 L299.5,140.7656 L309.5,140.7656 L299.5,130.7656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="122.5" y="148.334">Is it a root platform tenant?</text><!--MD5=[891844a5ce18d50d477bdacc29a03b64]
class PolicyType--><g id="elem_PolicyType"><rect codeLine="28" fill="#F1F1F1" height="97.4648" id="PolicyType" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="2650" y="464.2656"/><ellipse cx="2665" cy="480.2656" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2669.1143,486.2656 L2661.3945,486.2656 L2661.3945,473.8726 L2669.1143,473.8726 L2669.1143,476.0308 L2663.8433,476.0308 L2663.8433,478.7036 L2668.6162,478.7036 L2668.6162,480.8618 L2663.8433,480.8618 L2663.8433,484.1074 L2669.1143,484.1074 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="2679" y="485.5566">PolicyType</text><line style="stroke:#181818;stroke-width:0.5;" x1="2651" x2="2753" y1="496.2656" y2="496.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="2656" y="513.8008">SYSTEM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="2656" y="530.2891">CUSTOM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="2656" y="546.7773">GLOBAL</text><line style="stroke:#181818;stroke-width:0.5;" x1="2651" x2="2753" y1="553.7305" y2="553.7305"/></g><!--MD5=[9445d644bbe92584b3fa45e77778917b]
class Policy--><g id="elem_Policy"><rect codeLine="33" fill="#F1F1F1" height="146.9297" id="Policy" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="230" x="2485" y="646.2656"/><ellipse cx="2576.25" cy="662.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2572.1777,658.0308 L2572.1777,655.8726 L2579.5571,655.8726 L2579.5571,658.0308 L2577.0918,658.0308 L2577.0918,666.1074 L2579.5571,666.1074 L2579.5571,668.2656 L2572.1777,668.2656 L2572.1777,666.1074 L2574.6431,666.1074 L2574.6431,658.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="39" x="2596.75" y="667.5566">Policy</text><line style="stroke:#181818;stroke-width:0.5;" x1="2486" x2="2714" y1="678.2656" y2="678.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="2491" y="695.8008">val id: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="2491" y="712.2891">val name: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132" x="2491" y="728.7773">val type: PolicyType</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="2491" y="745.2656">val description: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="2491" y="761.7539">val tenantId:String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="218" x="2491" y="778.2422">val statements: Set&lt;Statement&gt;</text><line style="stroke:#181818;stroke-width:0.5;" x1="2486" x2="2714" y1="785.1953" y2="785.1953"/></g><!--MD5=[354ba6fe2710e9f7c691253c66156a32]
class Effect--><g id="elem_Effect"><rect codeLine="41" fill="#F1F1F1" height="80.9766" id="Effect" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="2349" y="281.7656"/><ellipse cx="2364" cy="297.7656" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2368.1143,303.7656 L2360.3945,303.7656 L2360.3945,291.3726 L2368.1143,291.3726 L2368.1143,293.5308 L2362.8433,293.5308 L2362.8433,296.2036 L2367.6162,296.2036 L2367.6162,298.3618 L2362.8433,298.3618 L2362.8433,301.6074 L2368.1143,301.6074 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="2378" y="303.0566">Effect</text><line style="stroke:#181818;stroke-width:0.5;" x1="2350" x2="2418" y1="313.7656" y2="313.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="2355" y="331.3008">ALLOW</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="2355" y="347.7891">DENY</text><line style="stroke:#181818;stroke-width:0.5;" x1="2350" x2="2418" y1="354.7422" y2="354.7422"/></g><!--MD5=[dd3a6102b68975fd8f1a6314072b340a]
class RequestMatcher--><g id="elem_RequestMatcher"><rect codeLine="45" fill="#F1F1F1" height="64.4883" id="RequestMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="295" x="2665.5" y="116.2656"/><ellipse cx="2753.75" cy="132.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2749.6777,128.0308 L2749.6777,125.8726 L2757.0571,125.8726 L2757.0571,128.0308 L2754.5918,128.0308 L2754.5918,136.1074 L2757.0571,136.1074 L2757.0571,138.2656 L2749.6777,138.2656 L2749.6777,136.1074 L2752.1431,136.1074 L2752.1431,128.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="110" x="2774.25" y="137.5566">RequestMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="2666.5" x2="2959.5" y1="148.2656" y2="148.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="2666.5" x2="2959.5" y1="156.2656" y2="156.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="283" x="2671.5" y="173.8008">match(Request,SecurityContext): Boolean</text></g><!--MD5=[226a4eef5279541003c62db16c270ea5]
class ActionMatcher--><g id="elem_ActionMatcher"><rect codeLine="48" fill="#F1F1F1" height="48" id="ActionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131" x="2182.5" y="298.2656"/><ellipse cx="2197.5" cy="314.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2193.4277,310.0308 L2193.4277,307.8726 L2200.8071,307.8726 L2200.8071,310.0308 L2198.3418,310.0308 L2198.3418,318.1074 L2200.8071,318.1074 L2200.8071,320.2656 L2193.4277,320.2656 L2193.4277,318.1074 L2195.8931,318.1074 L2195.8931,310.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="99" x="2211.5" y="319.5566">ActionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="2183.5" x2="2312.5" y1="330.2656" y2="330.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="2183.5" x2="2312.5" y1="338.2656" y2="338.2656"/></g><!--MD5=[ce15d4ae5e7b4627c02fd240cc319742]
class ConditionMatcher--><g id="elem_ConditionMatcher"><rect codeLine="49" fill="#F1F1F1" height="48" id="ConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="155" x="2805.5" y="298.2656"/><ellipse cx="2820.5" cy="314.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2816.4277,310.0308 L2816.4277,307.8726 L2823.8071,307.8726 L2823.8071,310.0308 L2821.3418,310.0308 L2821.3418,318.1074 L2823.8071,318.1074 L2823.8071,320.2656 L2816.4277,320.2656 L2816.4277,318.1074 L2818.8931,318.1074 L2818.8931,310.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="123" x="2834.5" y="319.5566">ConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="2806.5" x2="2959.5" y1="330.2656" y2="330.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="2806.5" x2="2959.5" y1="338.2656" y2="338.2656"/></g><!--MD5=[a5f8f54a8c595155ff6d10bcb2300aea]
class VerifyResult--><g id="elem_VerifyResult"><rect codeLine="50" fill="#F1F1F1" height="97.4648" id="VerifyResult" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115" x="2515.5" y="99.7656"/><ellipse cx="2531.4" cy="115.7656" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2535.5143,121.7656 L2527.7945,121.7656 L2527.7945,109.3726 L2535.5143,109.3726 L2535.5143,111.5308 L2530.2433,111.5308 L2530.2433,114.2036 L2535.0162,114.2036 L2535.0162,116.3618 L2530.2433,116.3618 L2530.2433,119.6074 L2535.5143,119.6074 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="2545.6" y="121.0566">VerifyResult</text><line style="stroke:#181818;stroke-width:0.5;" x1="2516.5" x2="2629.5" y1="131.7656" y2="131.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="2521.5" y="149.3008">ALLOW</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="2521.5" y="165.7891">EXPLICIT_DENY</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="2521.5" y="182.2773">IMPLICIT_DENY</text><line style="stroke:#181818;stroke-width:0.5;" x1="2516.5" x2="2629.5" y1="189.2305" y2="189.2305"/></g><!--MD5=[a61a298976b7d1d94498f45c2ebfa10b]
class Statement--><g id="elem_Statement"><rect codeLine="55" fill="#F1F1F1" height="113.9531" id="Statement" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="234" x="2381" y="455.7656"/><ellipse cx="2459.25" cy="471.7656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2455.1777,467.5308 L2455.1777,465.3726 L2462.5571,465.3726 L2462.5571,467.5308 L2460.0918,467.5308 L2460.0918,475.6074 L2462.5571,475.6074 L2462.5571,477.7656 L2455.1777,477.7656 L2455.1777,475.6074 L2457.6431,475.6074 L2457.6431,467.5308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="69" x="2479.75" y="477.0566">Statement</text><line style="stroke:#181818;stroke-width:0.5;" x1="2382" x2="2614" y1="487.7656" y2="487.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="2387" y="505.3008">val name: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="2387" y="521.7891">val effect: Effect</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222" x="2387" y="538.2773">val actions: Set&lt;ActionMatcher&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="219" x="2387" y="554.7656">val condition: ConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="2382" x2="2614" y1="561.7188" y2="561.7188"/></g><!--MD5=[25907446179e7e8284c1a5a6eb221e77]
class PermissionVerifier--><g id="elem_PermissionVerifier"><rect codeLine="62" fill="#F1F1F1" height="64.4883" id="PermissionVerifier" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="316" x="2454" y="290.2656"/><ellipse cx="2545.25" cy="306.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2541.1777,302.0308 L2541.1777,299.8726 L2548.5571,299.8726 L2548.5571,302.0308 L2546.0918,302.0308 L2546.0918,310.1074 L2548.5571,310.1074 L2548.5571,312.2656 L2541.1777,312.2656 L2541.1777,310.1074 L2543.6431,310.1074 L2543.6431,302.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="125" x="2565.75" y="311.5566">PermissionVerifier</text><line style="stroke:#181818;stroke-width:0.5;" x1="2455" x2="2769" y1="322.2656" y2="322.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="2455" x2="2769" y1="330.2656" y2="330.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="304" x="2460" y="347.8008">verify(Request,SecurityContext): VerifyResult</text></g><!--MD5=[4a8e06406f0c0425d99e01150b1292e5]
class PolicyEvaluator--><g id="elem_PolicyEvaluator"><rect codeLine="65" fill="#F1F1F1" height="64.4883" id="PolicyEvaluator" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="135" x="2012.5" y="290.2656"/><ellipse cx="2027.5" cy="306.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2023.4277,302.0308 L2023.4277,299.8726 L2030.8071,299.8726 L2030.8071,302.0308 L2028.3418,302.0308 L2028.3418,310.1074 L2030.8071,310.1074 L2030.8071,312.2656 L2023.4277,312.2656 L2023.4277,310.1074 L2025.8931,310.1074 L2025.8931,302.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="103" x="2041.5" y="311.5566">PolicyEvaluator</text><line style="stroke:#181818;stroke-width:0.5;" x1="2013.5" x2="2146.5" y1="322.2656" y2="322.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="2013.5" x2="2146.5" y1="330.2656" y2="330.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="2018.5" y="347.8008">evaluate(Policy)</text></g><!--MD5=[79431584796416a68bc6cb91e9d847cd]
class PolicyCapable--><g id="elem_PolicyCapable"><rect codeLine="68" fill="#F1F1F1" height="64.4883" id="PolicyCapable" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="179" x="1947.5" y="116.2656"/><ellipse cx="1985.9" cy="132.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1981.8277,128.0308 L1981.8277,125.8726 L1989.2071,125.8726 L1989.2071,128.0308 L1986.7418,128.0308 L1986.7418,136.1074 L1989.2071,136.1074 L1989.2071,138.2656 L1981.8277,138.2656 L1981.8277,136.1074 L1984.2931,136.1074 L1984.2931,128.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="95" x="2005.1" y="137.5566">PolicyCapable</text><line style="stroke:#181818;stroke-width:0.5;" x1="1948.5" x2="2125.5" y1="148.2656" y2="148.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="167" x="1953.5" y="165.8008">val policies: Set&lt;String&gt;</text><line style="stroke:#181818;stroke-width:0.5;" x1="1948.5" x2="2125.5" y1="172.7539" y2="172.7539"/></g><g id="elem_GMN29"><path d="M2162,135.7656 L2162,161.0762 L2480,161.0762 L2480,145.7656 L2470,135.7656 L2162,135.7656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2470,135.7656 L2470,145.7656 L2480,145.7656 L2470,135.7656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297" x="2168" y="153.334">Used to evaluate the effectiveness of the Policy</text></g><!--MD5=[52681581877b3e7248987c87e027ce58]
class RoleCapable--><g id="elem_RoleCapable"><rect codeLine="89" fill="#F1F1F1" height="64.4883" id="RoleCapable" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="161" x="926.5" y="290.2656"/><ellipse cx="960.85" cy="306.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M956.7777,302.0308 L956.7777,299.8726 L964.1571,299.8726 L964.1571,302.0308 L961.6918,302.0308 L961.6918,310.1074 L964.1571,310.1074 L964.1571,312.2656 L956.7777,312.2656 L956.7777,310.1074 L959.2431,310.1074 L959.2431,302.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="86" x="979.15" y="311.5566">RoleCapable</text><line style="stroke:#181818;stroke-width:0.5;" x1="927.5" x2="1086.5" y1="322.2656" y2="322.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="932.5" y="339.8008">val roles: Set&lt;String&gt;</text><line style="stroke:#181818;stroke-width:0.5;" x1="927.5" x2="1086.5" y1="346.7539" y2="346.7539"/></g><!--MD5=[05e3ec1b6d12f04f2c7c7eb2dc3e534b]
class CoSecPrincipal--><g id="elem_CoSecPrincipal"><rect codeLine="92" fill="#F1F1F1" height="113.9531" id="CoSecPrincipal" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="250" x="641" y="265.2656"/><ellipse cx="711.25" cy="281.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M707.1777,277.0308 L707.1777,274.8726 L714.5571,274.8726 L714.5571,277.0308 L712.0918,277.0308 L712.0918,285.1074 L714.5571,285.1074 L714.5571,287.2656 L707.1777,287.2656 L707.1777,285.1074 L709.6431,285.1074 L709.6431,277.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="101" x="731.75" y="286.5566">CoSecPrincipal</text><line style="stroke:#181818;stroke-width:0.5;" x1="642" x2="890" y1="297.2656" y2="297.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="647" y="314.8008">val id: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="238" x="647" y="331.2891">val attributes: Map&lt;String, String&gt;</text><line style="stroke:#181818;stroke-width:0.5;" x1="642" x2="890" y1="338.2422" y2="338.2422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="153" x="647" y="355.7773">anonymous(): Boolean</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="167" x="647" y="372.2656">authenticated(): Boolean</text></g><!--MD5=[dcd1c42ae96b3f450c53e1d5a4b38ac2]
class TenantPrincipal--><g id="elem_TenantPrincipal"><rect codeLine="98" fill="#F1F1F1" height="48" id="TenantPrincipal" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="696.5" y="488.7656"/><ellipse cx="711.5" cy="504.7656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M707.4277,500.5308 L707.4277,498.3726 L714.8071,498.3726 L714.8071,500.5308 L712.3418,500.5308 L712.3418,508.6074 L714.8071,508.6074 L714.8071,510.7656 L707.4277,510.7656 L707.4277,508.6074 L709.8931,508.6074 L709.8931,500.5308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="107" x="725.5" y="510.0566">TenantPrincipal</text><line style="stroke:#181818;stroke-width:0.5;" x1="697.5" x2="834.5" y1="520.7656" y2="520.7656"/><line style="stroke:#181818;stroke-width:0.5;" x1="697.5" x2="834.5" y1="528.7656" y2="528.7656"/></g><path d="M1122.5,304.7656 L1122.5,313.4209 L1081.5,334.5098 L1122.5,321.4209 L1122.5,330.0762 A0,0 0 0 0 1122.5,330.0762 L1227.5,330.0762 A0,0 0 0 0 1227.5,330.0762 L1227.5,314.7656 L1217.5,304.7656 L1122.5,304.7656 A0,0 0 0 0 1122.5,304.7656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1217.5,304.7656 L1217.5,314.7656 L1227.5,314.7656 L1217.5,304.7656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="1128.5" y="322.334">A set of roles</text><!--MD5=[e2dc22e8225a918eadd77002df418415]
class java.security.Principal--><g id="elem_java.security.Principal"><rect codeLine="86" fill="#F1F1F1" height="64.4883" id="java.security.Principal" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="128" x="802" y="116.2656"/><ellipse cx="833.65" cy="132.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M829.5777,128.0308 L829.5777,125.8726 L836.9571,125.8726 L836.9571,128.0308 L834.4918,128.0308 L834.4918,136.1074 L836.9571,136.1074 L836.9571,138.2656 L829.5777,138.2656 L829.5777,136.1074 L832.0431,136.1074 L832.0431,128.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="59" x="851.35" y="137.5566">Principal</text><line style="stroke:#181818;stroke-width:0.5;" x1="803" x2="929" y1="148.2656" y2="148.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="803" x2="929" y1="156.2656" y2="156.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="808" y="173.8008">getName():String</text></g><!--MD5=[86b30c3e0fe779331a576db045bd0856]
class SecurityContext--><g id="elem_SecurityContext"><rect codeLine="111" fill="#F1F1F1" height="113.9531" id="SecurityContext" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="313" x="271.5" y="455.7656"/><ellipse cx="369.25" cy="471.7656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M365.1777,467.5308 L365.1777,465.3726 L372.5571,465.3726 L372.5571,467.5308 L370.0918,467.5308 L370.0918,475.6074 L372.5571,475.6074 L372.5571,477.7656 L365.1777,477.7656 L365.1777,475.6074 L367.6431,475.6074 L367.6431,467.5308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="109" x="389.75" y="477.0566">SecurityContext</text><line style="stroke:#181818;stroke-width:0.5;" x1="272.5" x2="583.5" y1="487.7656" y2="487.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="192" x="277.5" y="505.3008">val principal: CoSecPrincipal</text><line style="stroke:#181818;stroke-width:0.5;" x1="272.5" x2="583.5" y1="512.2539" y2="512.2539"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="301" x="277.5" y="529.7891">setAttribute(String, Object): SecurityContext</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="157" x="277.5" y="546.2773">getAttribute(String): T?</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="213" x="277.5" y="562.7656">getRequiredAttribute(String): T</text></g><!--MD5=[0851f84a889f989e7bb0bebc385d0f09]
class Request--><g id="elem_Request"><rect codeLine="120" fill="#F1F1F1" height="146.9297" id="Request" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="214" x="22" y="439.2656"/><ellipse cx="97.25" cy="455.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M93.1777,451.0308 L93.1777,448.8726 L100.5571,448.8726 L100.5571,451.0308 L98.0918,451.0308 L98.0918,459.1074 L100.5571,459.1074 L100.5571,461.2656 L93.1777,461.2656 L93.1777,459.1074 L95.6431,459.1074 L95.6431,451.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="55" x="117.75" y="460.5566">Request</text><line style="stroke:#181818;stroke-width:0.5;" x1="23" x2="235" y1="471.2656" y2="471.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="28" y="488.8008">val path: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="28" y="505.2891">val method: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="28" y="521.7773">val remoteIp: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="28" y="538.2656">val origin: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="28" y="554.7539">val referer: String</text><line style="stroke:#181818;stroke-width:0.5;" x1="23" x2="235" y1="561.707" y2="561.707"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="202" x="28" y="579.2422">getHeader(key: String): String</text></g><!--MD5=[eaab7d2ddd4405c2c7244fd25dd0c172]
class AuthorizeResult--><g id="elem_AuthorizeResult"><rect codeLine="131" fill="#F1F1F1" height="80.9766" id="AuthorizeResult" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="173" x="558.5" y="679.2656"/><ellipse cx="587.45" cy="695.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M583.3777,691.0308 L583.3777,688.8726 L590.7571,688.8726 L590.7571,691.0308 L588.2918,691.0308 L588.2918,699.1074 L590.7571,699.1074 L590.7571,701.2656 L583.3777,701.2656 L583.3777,699.1074 L585.8431,699.1074 L585.8431,691.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="110" x="604.55" y="700.5566">AuthorizeResult</text><line style="stroke:#181818;stroke-width:0.5;" x1="559.5" x2="730.5" y1="711.2656" y2="711.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="564.5" y="728.8008">val authorized: Boolean</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="564.5" y="745.2891">val reason: String</text><line style="stroke:#181818;stroke-width:0.5;" x1="559.5" x2="730.5" y1="752.2422" y2="752.2422"/></g><!--MD5=[16baea6be49bb9991e615d76903392b3]
class Authorization--><g id="elem_Authorization"><rect codeLine="135" fill="#F1F1F1" height="64.4883" id="Authorization" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="435" x="88.5" y="687.7656"/><ellipse cx="254.25" cy="703.7656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M250.1777,699.5308 L250.1777,697.3726 L257.5571,697.3726 L257.5571,699.5308 L255.0918,699.5308 L255.0918,707.6074 L257.5571,707.6074 L257.5571,709.7656 L250.1777,709.7656 L250.1777,707.6074 L252.6431,707.6074 L252.6431,699.5308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="95" x="274.75" y="709.0566">Authorization</text><line style="stroke:#181818;stroke-width:0.5;" x1="89.5" x2="522.5" y1="719.7656" y2="719.7656"/><line style="stroke:#181818;stroke-width:0.5;" x1="89.5" x2="522.5" y1="727.7656" y2="727.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="423" x="94.5" y="745.3008">authorize(Request,SecurityContext): Mono&lt;AuthorizeResult&gt;</text></g><!--MD5=[63e7a34560323ddebc94de26bb3dfe24]
class Credentials--><g id="elem_Credentials"><rect codeLine="143" fill="#F1F1F1" height="48" id="Credentials" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="1385" y="298.2656"/><ellipse cx="1400" cy="314.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1395.9277,310.0308 L1395.9277,307.8726 L1403.3071,307.8726 L1403.3071,310.0308 L1400.8418,310.0308 L1400.8418,318.1074 L1403.3071,318.1074 L1403.3071,320.2656 L1395.9277,320.2656 L1395.9277,318.1074 L1398.3931,318.1074 L1398.3931,310.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="78" x="1414" y="319.5566">Credentials</text><line style="stroke:#181818;stroke-width:0.5;" x1="1386" x2="1494" y1="330.2656" y2="330.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="1386" x2="1494" y1="338.2656" y2="338.2656"/></g><!--MD5=[a139e992f8a77546bf37c14edd197f06]
class Authentication--><g id="elem_Authentication"><rect codeLine="144" fill="#F1F1F1" height="80.9766" id="Authentication" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="312" x="1284" y="472.2656"/><ellipse cx="1299" cy="488.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1294.9277,484.0308 L1294.9277,481.8726 L1302.3071,481.8726 L1302.3071,484.0308 L1299.8418,484.0308 L1299.8418,492.1074 L1302.3071,492.1074 L1302.3071,494.2656 L1294.9277,494.2656 L1294.9277,492.1074 L1297.3931,492.1074 L1297.3931,484.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="101" x="1313" y="493.5566">Authentication</text><rect fill="#FFFFFF" height="16.1328" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="177" x="1422" y="469.2656"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="175" x="1423" y="481.8672">C:Credentials,P:CoSecPrincipal</text><line style="stroke:#181818;stroke-width:0.5;" x1="1285" x2="1595" y1="504.2656" y2="504.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="208" x="1290" y="521.8008">supportCredentials: Class&lt;C&gt;</text><line style="stroke:#181818;stroke-width:0.5;" x1="1285" x2="1595" y1="528.7539" y2="528.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="182" x="1290" y="546.2891">authenticate(C): Mono&lt;P&gt;</text></g><!--MD5=[f074fdee743888442a4f97901e556f9c]
class AuthenticationProvider--><g id="elem_AuthenticationProvider"><rect codeLine="148" fill="#F1F1F1" height="146.9297" id="AuthenticationProvider" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="260" x="1631" y="439.2656"/><ellipse cx="1677.75" cy="455.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1673.6777,451.0308 L1673.6777,448.8726 L1681.0571,448.8726 L1681.0571,451.0308 L1678.5918,451.0308 L1678.5918,459.1074 L1681.0571,459.1074 L1681.0571,461.2656 L1673.6777,461.2656 L1673.6777,459.1074 L1676.1431,459.1074 L1676.1431,451.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="158" x="1698.25" y="460.5566">AuthenticationProvider</text><line style="stroke:#181818;stroke-width:0.5;" x1="1632" x2="1890" y1="471.2656" y2="471.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="1632" x2="1890" y1="479.2656" y2="479.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="192" x="1637" y="496.8008">get(Class&lt;Credentials&gt;): A?</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="248" x="1637" y="513.2891">getRequired(Class&lt;Credentials&gt;): A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="1637" y="529.7773">register(A): Unit</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185" x="1637" y="546.2656">register(Class&lt;C&gt;, A): Unit</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="1637" y="562.7539">register(A): Unit</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="248" x="1637" y="579.2422">getRequired(Class&lt;Credentials&gt;): A</text></g><!--MD5=[7c5c88a606935469d5f89b0b5794816c]
class Named--><g id="elem_Named"><rect codeLine="5" fill="#F1F1F1" height="64.4883" id="Named" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="667.5" y="116.2656"/><ellipse cx="691.05" cy="132.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M686.9777,128.0308 L686.9777,125.8726 L694.3571,125.8726 L694.3571,128.0308 L691.8918,128.0308 L691.8918,136.1074 L694.3571,136.1074 L694.3571,138.2656 L686.9777,138.2656 L686.9777,136.1074 L689.4431,136.1074 L689.4431,128.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="48" x="706.95" y="137.5566">Named</text><line style="stroke:#181818;stroke-width:0.5;" x1="668.5" x2="765.5" y1="148.2656" y2="148.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="673.5" y="165.8008">name: String</text><line style="stroke:#181818;stroke-width:0.5;" x1="668.5" x2="765.5" y1="172.7539" y2="172.7539"/></g><!--MD5=[d3fc1cb30f7bdcc9e19e497f9b6ed3e8]
link Tenant to TenantCapable--><g id="link_Tenant_TenantCapable"><path codeLine="20" d="M452,220.0456 C452,238.7556 452,276.4156 452,276.4156 " fill="none" id="Tenant-TenantCapable" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="452,207.0956,448,216.0956,452,212.0956,456,216.0956,452,207.0956" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="452" x2="452" y1="212.0956" y2="220.0956"/><polygon fill="#181818" points="452,288.4156,456,282.4156,452,276.4156,448,282.4156,452,288.4156" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[3a61d607afa5f9046415286ff45a7e54]
reverse link RequestMatcher to ActionMatcher--><g id="link_RequestMatcher_ActionMatcher"><path codeLine="71" d="M2714.62,187.5356 C2692.97,194.5756 2669.95,201.0356 2648,205.2656 C2578.95,218.5756 2395,191.0156 2332,222.2656 C2299.09,238.5956 2274.03,274.2656 2260.17,298.0256 " fill="none" id="RequestMatcher-backto-ActionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2712.25,180.9456,2733.44,181.1456,2716.75,194.2056,2712.25,180.9456" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[bdb7cf9e45c1a2c85396bf792a7d7532]
reverse link RequestMatcher to ConditionMatcher--><g id="link_RequestMatcher_ConditionMatcher"><path codeLine="72" d="M2833.75,200.2556 C2846.9,232.5756 2863.29,272.8356 2873.45,297.8056 " fill="none" id="RequestMatcher-backto-ConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2827.3,202.9756,2826.25,181.8156,2840.27,197.7056,2827.3,202.9756" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[99bd1ab024ee26fc6b7c63d9677fdb72]
reverse link PermissionVerifier to Statement--><g id="link_PermissionVerifier_Statement"><path codeLine="73" d="M2582.2,372.5456 C2566.83,397.9656 2548.01,429.0756 2532.06,455.4456 " fill="none" id="PermissionVerifier-backto-Statement" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="2576.05,369.1756,2592.39,355.6856,2588.03,376.4256,2576.05,369.1756" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e4eaaab51f62ef0fd17f62ea5476519c]
link Effect to Statement--><g id="link_Effect_Statement"><path codeLine="74" d="M2415.51,375.3756 C2428.2,396.3456 2456.9154,443.8402 2456.9154,443.8402 " fill="none" id="Effect-Statement" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2408.96,364.5356,2410.1936,374.3069,2411.547,368.8143,2417.0396,370.1677,2408.96,364.5356" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2411.547" x2="2415.685" y1="368.8143" y2="375.6606"/><polygon fill="#181818" points="2463.13,454.1056,2463.4445,446.9014,2456.9154,443.8402,2456.6009,451.0445,2463.13,454.1056" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[421c707edf9dcb67c653879c9588b357]
link ActionMatcher to Statement--><g id="link_ActionMatcher_Statement"><path codeLine="75" d="M2290.3,355.1656 C2323.45,380.1556 2412.2974,447.1424 2412.2974,447.1424 " fill="none" id="ActionMatcher-Statement" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2280.37,347.6656,2285.1435,356.2804,2284.3607,350.6779,2289.9632,349.8952,2280.37,347.6656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2284.3607" x2="2290.75" y1="350.6779" y2="355.4956"/><polygon fill="#181818" points="2421.88,454.3656,2419.4964,447.5598,2412.2974,447.1424,2414.681,453.9482,2421.88,454.3656" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[04f4abb29adabcf38a547a8eb9430c3b]
link ConditionMatcher to Statement--><g id="link_ConditionMatcher_Statement"><path codeLine="76" d="M2839.38,354.2156 C2823.84,363.7856 2805.78,373.3556 2788,379.2656 C2722.24,401.1256 2696.6,368.7356 2633,396.2656 C2606.24,407.8456 2558.8938,446.2238 2558.8938,446.2238 " fill="none" id="ConditionMatcher-Statement" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2849.97,347.4256,2840.2344,348.9149,2845.7605,350.1239,2844.5516,355.65,2849.97,347.4256" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2845.7605" x2="2839.025" y1="350.1239" y2="354.4356"/><polygon fill="#181818" points="2550.06,454.3456,2557.1842,453.2293,2558.8938,446.2238,2551.7696,447.3401,2550.06,454.3456" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e3680ece5eb6e2539ae6dce9363554de]
link PolicyType to Policy--><g id="link_PolicyType_Policy"><path codeLine="77" d="M2671.84,574.3756 C2662.68,592.7856 2642.2607,633.8446 2642.2607,633.8446 " fill="none" id="PolicyType-Policy" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2677.54,562.9256,2669.9435,569.1941,2675.3083,567.4,2677.1025,572.7648,2677.54,562.9256" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2675.3083" x2="2671.75" y1="567.4" y2="574.5656"/><polygon fill="#181818" points="2636.91,644.5856,2643.1657,640.9987,2642.2607,633.8446,2636.005,637.4315,2636.91,644.5856" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a7b3af78aa4d03cb0e67dc6b5e1b33d1]
link Statement to Policy--><g id="link_Statement_Policy"><path codeLine="78" d="M2532.34,582.7756 C2540.41,598.9956 2557.8098,633.9493 2557.8098,633.9493 " fill="none" id="Statement-Policy" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2526.68,571.4056,2527.103,581.2454,2528.9051,575.8832,2534.2672,577.6853,2526.68,571.4056" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2528.9051" x2="2532.475" y1="575.8832" y2="583.0506"/><polygon fill="#181818" points="2563.15,644.6956,2564.062,637.5424,2557.8098,633.9493,2556.8978,641.1025,2563.15,644.6956" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f6501252c65be42b38a34c7ff3f78362]
link GMN29 to PolicyEvaluator--><g id="link_GMN29_PolicyEvaluator"><path d="M2284.87,161.1856 C2251.63,173.2556 2202.03,194.1456 2165,222.2656 C2139.92,241.3056 2117.02,268.8556 2101.32,290.0656 " fill="none" id="GMN29-PolicyEvaluator" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/></g><!--MD5=[017c10c76ce2d36bd60f0dc62a4a72a8]
reverse link java.security.Principal to CoSecPrincipal--><g id="link_java.security.Principal_CoSecPrincipal"><path codeLine="99" d="M837.11,198.9556 C825.11,219.6056 811.12,243.6656 798.74,264.9556 " fill="none" id="java.security.Principal-backto-CoSecPrincipal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="831.03,195.4956,847.13,181.7256,843.13,202.5256,831.03,195.4956" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[5b5054689bf2020954aca84a99bf32ab]
reverse link TenantCapable to TenantPrincipal--><g id="link_TenantCapable_TenantPrincipal"><path codeLine="100" d="M539.53,363.3356 C560.02,373.4856 581.54,384.7856 601,396.2656 C649.93,425.1456 703.23,463.8956 735.63,488.3556 " fill="none" id="TenantCapable-backto-TenantPrincipal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="536.58,369.6856,521.66,354.6456,542.7,357.0956,536.58,369.6856" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e7f6508ff043c461a5f165263bc71b5b]
reverse link CoSecPrincipal to TenantPrincipal--><g id="link_CoSecPrincipal_TenantPrincipal"><path codeLine="101" d="M766,400.8456 C766,432.4456 766,466.6256 766,488.5656 " fill="none" id="CoSecPrincipal-backto-TenantPrincipal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="759,401.0756,766,381.0756,773,401.0756,759,401.0756" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[c7c8313ddc0bad273885a8234da768c1]
reverse link Named to CoSecPrincipal--><g id="link_Named_CoSecPrincipal"><path codeLine="102" d="M731.7,200.8856 C737.46,221.0856 744.08,244.3256 749.96,264.9556 " fill="none" id="Named-backto-CoSecPrincipal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="725.04,203.0256,726.29,181.8656,738.5,199.1856,725.04,203.0256" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[903468ed3f54634ff2089a3230707525]
reverse link RoleCapable to TenantPrincipal--><g id="link_RoleCapable_TenantPrincipal"><path codeLine="103" d="M950.08,367.7856 C901.74,405.5956 834.27,458.3656 795.87,488.3956 " fill="none" id="RoleCapable-backto-TenantPrincipal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="945.67,362.3456,965.74,355.5356,954.3,373.3756,945.67,362.3456" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2e9dd4d24c620f4ef4c09958d90dc0d9]
reverse link PolicyCapable to CoSecPrincipal--><g id="link_PolicyCapable_CoSecPrincipal"><path codeLine="104" d="M1926.06,148.9556 C1679.77,149.4556 1094.52,157.6656 909,222.2656 C881.48,231.8456 854.39,248.2756 831.31,265.0256 " fill="none" id="PolicyCapable-backto-CoSecPrincipal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1925.89,141.9556,1945.9,148.9256,1925.9,155.9556,1925.89,141.9556" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[b1a9f71c494fe876e4b85e22ffb61b43]
reverse link TenantCapable to SecurityContext--><g id="link_TenantCapable_SecurityContext"><path codeLine="117" d="M445.34,375.5556 C442.18,400.3956 438.4,430.1156 435.17,455.4456 " fill="none" id="TenantCapable-backto-SecurityContext" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="438.38,374.8456,447.85,355.8956,452.26,376.6156,438.38,374.8456" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0c4cc86a4eab11f0ad45d9e81ff75b78]
link CoSecPrincipal to SecurityContext--><g id="link_CoSecPrincipal_SecurityContext"><path codeLine="118" d="M655.63,379.6956 C645.24,385.2256 634.9,390.8056 625,396.2656 C595.23,412.6856 563.3,431.0656 534,448.2456 " fill="none" id="CoSecPrincipal-to-SecurityContext" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="522.92,454.7556,530.1194,455.1665,533.2676,448.6789,526.0682,448.268,522.92,454.7556" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[30076c0053eee824d8d2442e12969676]
reverse link Request to Authorization--><g id="link_Request_Authorization"><path codeLine="138" d="M196.12,591.5056 C224.88,624.8156 256.84,661.8356 278.85,687.3156 " fill="none" id="Request-backto-Authorization" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="192.89,587.7656,195.7481,597.1907,196.1592,591.5488,201.8011,591.9599,192.89,587.7656" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[7ca05d895fd4d3e3cb6ad83c182c7856]
reverse link SecurityContext to Authorization--><g id="link_SecurityContext_Authorization"><path codeLine="139" d="M391.3,575.4356 C369.32,612.3656 342.31,657.7456 324.65,687.4256 " fill="none" id="SecurityContext-backto-Authorization" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="393.73,571.3556,385.6835,577.0348,391.1681,575.6494,392.5535,581.134,393.73,571.3556" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[6b6dcf69d22c7b7e80e54001a420a613]
reverse link CoSecPrincipal to Authentication--><g id="link_CoSecPrincipal_Authentication"><path codeLine="156" d="M897.38,376.5256 C901.27,377.5156 905.15,378.4356 909,379.2656 C1054.74,410.6356 1101.21,353.4056 1244,396.2656 C1296.96,412.1656 1350.61,445.2156 1388.36,471.9056 " fill="none" id="CoSecPrincipal-backto-Authentication" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="892.71,375.2856,900.3777,381.4667,897.5416,376.5722,902.4362,373.7361,892.71,375.2856" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[615981591744dbfd257bd758771ab80b]
reverse link Credentials to Authentication--><g id="link_Credentials_Authentication"><path codeLine="157" d="M1440,352.9056 C1440,384.9456 1440,436.2156 1440,471.8056 " fill="none" id="Credentials-backto-Authentication" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="1440,348.2756,1436,357.2756,1440,353.2756,1444,357.2756,1440,348.2756" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[40d5522495084d761aba8f9786b248b8]
link Authentication to AuthenticationProvider--><g id="link_Authentication_AuthenticationProvider"><path codeLine="158" d="M1610.93,512.7656 C1612.8,512.7656 1617.3,512.7656 1617.3,512.7656 " fill="none" id="Authentication-AuthenticationProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1597.94,512.7656,1606.94,516.7656,1602.94,512.7656,1606.94,508.7656,1597.94,512.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1602.94" x2="1610.94" y1="512.7656" y2="512.7656"/><polygon fill="#181818" points="1629.3,512.7656,1623.3,508.7656,1617.3,512.7656,1623.3,516.7656,1629.3,512.7656" style="stroke:#181818;stroke-width:1.0;"/></g><a href="https://github.com/Ahoo-Wang/CoSec" target="_top" title="https://github.com/Ahoo-Wang/CoSec" xlink:actuate="onRequest" xlink:href="https://github.com/Ahoo-Wang/CoSec" xlink:show="new" xlink:title="https://github.com/Ahoo-Wang/CoSec" xlink:type="simple"><text fill="#808080" font-family="sans-serif" font-size="10" lengthAdjust="spacing" text-decoration="underline" textLength="189" x="1390.5" y="824.9336">https://github.com/Ahoo-Wang/CoSec</text></a><!--MD5=[f41e9cfb460b549490c5a54ba01a5ee2]
@startuml
!include layout.puml

title CoSec Modeling Class Diagram

interface Named{
    name: String
}

package tenant{
    interface Tenant {
       val tenantId: String
       val isPlatformTenant: Boolean
       val isDefaultTenant: Boolean
       val isUserTenant: Boolean
    }
    interface TenantCapable {
        val tenant: Tenant
    }

    Tenant <- -*  TenantCapable

    note left of Tenant::isPlatform
        Is it a root platform tenant?
    end note
}

package policy{
    enum PolicyType {
        SYSTEM
        CUSTOM
        GLOBAL
    }
    interface Policy {
        val id: String
        val name: String
        val type: PolicyType
        val description: String
        val tenantId:String
        val statements: Set<Statement>
    }
    enum Effect {
        ALLOW
        DENY
    }
    interface RequestMatcher {
        match(Request,SecurityContext): Boolean
    }
    interface ActionMatcher
    interface ConditionMatcher
    enum VerifyResult{
        ALLOW
        EXPLICIT_DENY
        IMPLICIT_DENY
    }
    interface Statement{
        val name: String
        val effect: Effect
        val actions: Set<ActionMatcher>
        val condition: ConditionMatcher
    }

    interface PermissionVerifier {
        verify(Request,SecurityContext): VerifyResult
    }
    interface PolicyEvaluator {
        evaluate(Policy)
    }
    interface PolicyCapable {
        val policies: Set<String>
    }
    RequestMatcher <|- - ActionMatcher
    RequestMatcher <|- - ConditionMatcher
    PermissionVerifier <|- - Statement
    Effect <- -*  Statement
    ActionMatcher <- -*  Statement
    ConditionMatcher <- -*  Statement
    PolicyType <- -*  Policy
    Statement <- -*  Policy

    note top of PolicyEvaluator
        Used to evaluate the effectiveness of the Policy
    end note
}

package principal{
    interface java.security.Principal{
        getName():String
    }
    interface RoleCapable {
        val roles: Set<String>
    }
    interface CoSecPrincipal{
        val id: String
        val attributes: Map<String, String>
        anonymous(): Boolean
        authenticated(): Boolean
    }
    interface TenantPrincipal
    java.security.Principal <|- - CoSecPrincipal
    TenantCapable <|- - TenantPrincipal
    CoSecPrincipal <|- - TenantPrincipal
    Named <|- - CoSecPrincipal
    RoleCapable <|- - TenantPrincipal
    PolicyCapable <|- - CoSecPrincipal
    note right of RoleCapable::role
        A set of roles
    end note
}

package context{
    interface SecurityContext {
        val principal: CoSecPrincipal
        setAttribute(String, Object): SecurityContext
        getAttribute(String): T?
        getRequiredAttribute(String): T
    }
    TenantCapable <|- -  SecurityContext
    CoSecPrincipal - -* SecurityContext

    interface Request{
        val path: String
        val method: String
        val remoteIp: String
        val origin: String
        val referer: String
        getHeader(key: String): String
    }
}

package authorization{
    interface AuthorizeResult {
        val authorized: Boolean
        val reason: String
    }
    interface Authorization {
        authorize(Request,SecurityContext): Mono<AuthorizeResult>
    }
    Request <-[dashed]- Authorization
    SecurityContext <-[dashed]- Authorization
}

package authentication{
    interface Credentials
    interface Authentication<C:Credentials,P:CoSecPrincipal>{
       authenticate(C): Mono<P>
       supportCredentials: Class<C>
    }
    interface AuthenticationProvider{
       get(Class<Credentials>): A?
       getRequired(Class<Credentials>): A
       register(A): Unit
       register(Class<C>, A): Unit
       register(A): Unit
       getRequired(Class<Credentials>): A
    }
    CoSecPrincipal <-[dashed]- Authentication
    Credentials <-[dashed]- Authentication
    Authentication <-* AuthenticationProvider
}

@enduml

@startuml
skinparam hyperlinkColor grey


header
[[https://github.com/Ahoo-Wang/CoSec]]
endheader

center footer [[https://github.com/Ahoo-Wang/CoSec]]


title CoSec Modeling Class Diagram

interface Named{
    name: String
}

package tenant{
    interface Tenant {
       val tenantId: String
       val isPlatformTenant: Boolean
       val isDefaultTenant: Boolean
       val isUserTenant: Boolean
    }
    interface TenantCapable {
        val tenant: Tenant
    }

    Tenant <- -*  TenantCapable

    note left of Tenant::isPlatform
        Is it a root platform tenant?
    end note
}

package policy{
    enum PolicyType {
        SYSTEM
        CUSTOM
        GLOBAL
    }
    interface Policy {
        val id: String
        val name: String
        val type: PolicyType
        val description: String
        val tenantId:String
        val statements: Set<Statement>
    }
    enum Effect {
        ALLOW
        DENY
    }
    interface RequestMatcher {
        match(Request,SecurityContext): Boolean
    }
    interface ActionMatcher
    interface ConditionMatcher
    enum VerifyResult{
        ALLOW
        EXPLICIT_DENY
        IMPLICIT_DENY
    }
    interface Statement{
        val name: String
        val effect: Effect
        val actions: Set<ActionMatcher>
        val condition: ConditionMatcher
    }

    interface PermissionVerifier {
        verify(Request,SecurityContext): VerifyResult
    }
    interface PolicyEvaluator {
        evaluate(Policy)
    }
    interface PolicyCapable {
        val policies: Set<String>
    }
    RequestMatcher <|- - ActionMatcher
    RequestMatcher <|- - ConditionMatcher
    PermissionVerifier <|- - Statement
    Effect <- -*  Statement
    ActionMatcher <- -*  Statement
    ConditionMatcher <- -*  Statement
    PolicyType <- -*  Policy
    Statement <- -*  Policy

    note top of PolicyEvaluator
        Used to evaluate the effectiveness of the Policy
    end note
}

package principal{
    interface java.security.Principal{
        getName():String
    }
    interface RoleCapable {
        val roles: Set<String>
    }
    interface CoSecPrincipal{
        val id: String
        val attributes: Map<String, String>
        anonymous(): Boolean
        authenticated(): Boolean
    }
    interface TenantPrincipal
    java.security.Principal <|- - CoSecPrincipal
    TenantCapable <|- - TenantPrincipal
    CoSecPrincipal <|- - TenantPrincipal
    Named <|- - CoSecPrincipal
    RoleCapable <|- - TenantPrincipal
    PolicyCapable <|- - CoSecPrincipal
    note right of RoleCapable::role
        A set of roles
    end note
}

package context{
    interface SecurityContext {
        val principal: CoSecPrincipal
        setAttribute(String, Object): SecurityContext
        getAttribute(String): T?
        getRequiredAttribute(String): T
    }
    TenantCapable <|- -  SecurityContext
    CoSecPrincipal - -* SecurityContext

    interface Request{
        val path: String
        val method: String
        val remoteIp: String
        val origin: String
        val referer: String
        getHeader(key: String): String
    }
}

package authorization{
    interface AuthorizeResult {
        val authorized: Boolean
        val reason: String
    }
    interface Authorization {
        authorize(Request,SecurityContext): Mono<AuthorizeResult>
    }
    Request <-[dashed]- Authorization
    SecurityContext <-[dashed]- Authorization
}

package authentication{
    interface Credentials
    interface Authentication<C:Credentials,P:CoSecPrincipal>{
       authenticate(C): Mono<P>
       supportCredentials: Class<C>
    }
    interface AuthenticationProvider{
       get(Class<Credentials>): A?
       getRequired(Class<Credentials>): A
       register(A): Unit
       register(Class<C>, A): Unit
       register(A): Unit
       getRequired(Class<Credentials>): A
    }
    CoSecPrincipal <-[dashed]- Authentication
    Credentials <-[dashed]- Authentication
    Authentication <-* AuthenticationProvider
}

@enduml

PlantUML version 1.2022.13(Sat Nov 19 21:22:17 CST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>
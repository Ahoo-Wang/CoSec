<?xml version="1.0" encoding="UTF-8" standalone="no"?><!--
  - Copyright [2021-present] [ahoo wang <ahoowang@qq.com> (https://github.com/Ahoo-Wang)].
  - Licensed under the Apache License, Version 2.0 (the "License");
  - you may not use this file except in compliance with the License.
  - You may obtain a copy of the License at
  -      http://www.apache.org/licenses/LICENSE-2.0
  - Unless required by applicable law or agreed to in writing, software
  - distributed under the License is distributed on an "AS IS" BASIS,
  - WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  - See the License for the specific language governing permissions and
  - limitations under the License.
  -->

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="644px" preserveAspectRatio="none" style="width:2798px;height:644px;background:#FFFFFF;" version="1.1" viewBox="0 0 2798 644" width="2798px" zoomAndPan="magnify"><defs/><g><a href="https://github.com/Ahoo-Wang/CoSec" target="_top" title="https://github.com/Ahoo-Wang/CoSec" xlink:actuate="onRequest" xlink:href="https://github.com/Ahoo-Wang/CoSec" xlink:show="new" xlink:title="https://github.com/Ahoo-Wang/CoSec" xlink:type="simple"><text fill="#808080" font-family="sans-serif" font-size="10" lengthAdjust="spacing" text-decoration="underline" textLength="189" x="2595.5" y="9.668">https://github.com/Ahoo-Wang/CoSec</text></a><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="189" x="1297.75" y="36.3125">Build In ConditionMatcher</text><!--MD5=[dd3a6102b68975fd8f1a6314072b340a]
class RequestMatcher--><g id="elem_RequestMatcher"><rect codeLine="6" fill="#F1F1F1" height="97.4648" id="RequestMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="475" x="1393.5" y="57.2656"/><ellipse cx="1571.75" cy="73.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1567.6777,69.0308 L1567.6777,66.8726 L1575.0571,66.8726 L1575.0571,69.0308 L1572.5918,69.0308 L1572.5918,77.1074 L1575.0571,77.1074 L1575.0571,79.2656 L1567.6777,79.2656 L1567.6777,77.1074 L1570.1431,77.1074 L1570.1431,69.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="110" x="1592.25" y="78.5566">RequestMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="1394.5" x2="1867.5" y1="89.2656" y2="89.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="1399.5" y="106.8008">val type: String</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="220" x="1399.5" y="123.2891">val configuration: Configuration</text><line style="stroke:#181818;stroke-width:0.5;" x1="1394.5" x2="1867.5" y1="130.2422" y2="130.2422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="463" x="1399.5" y="147.7773">match(request: Request, securityContext: SecurityContext): Boolean</text></g><!--MD5=[ce15d4ae5e7b4627c02fd240cc319742]
class ConditionMatcher--><g id="elem_ConditionMatcher"><rect codeLine="12" fill="#F1F1F1" height="48" id="ConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="155" x="1553.5" y="214.2656"/><ellipse cx="1568.5" cy="230.2656" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1564.4277,226.0308 L1564.4277,223.8726 L1571.8071,223.8726 L1571.8071,226.0308 L1569.3418,226.0308 L1569.3418,234.1074 L1571.8071,234.1074 L1571.8071,236.2656 L1564.4277,236.2656 L1564.4277,234.1074 L1566.8931,234.1074 L1566.8931,226.0308 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="123" x="1582.5" y="235.5566">ConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="1554.5" x2="1707.5" y1="246.2656" y2="246.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="1554.5" x2="1707.5" y1="254.2656" y2="254.2656"/></g><!--MD5=[39d0d676e1dca9841004a246af436b0b]
class AbstractConditionMatcher--><g id="elem_AbstractConditionMatcher"><rect codeLine="13" fill="#F1F1F1" height="64.4883" id="AbstractConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="212" x="1525" y="322.2656"/><ellipse cx="1540" cy="338.2656" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1540.1133,333.6138 L1538.9595,338.6855 L1541.2754,338.6855 Z M1538.6191,331.3726 L1541.6157,331.3726 L1544.9609,343.7656 L1542.5122,343.7656 L1541.7485,340.7026 L1538.4697,340.7026 L1537.7227,343.7656 L1535.2739,343.7656 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="180" x="1554" y="343.5566">AbstractConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="1526" x2="1736" y1="354.2656" y2="354.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133" x="1531" y="371.8008">val negate: Boolean</text><line style="stroke:#181818;stroke-width:0.5;" x1="1526" x2="1736" y1="378.7539" y2="378.7539"/></g><!--MD5=[eb17fed52537656bbddd2ca7c9949301]
class PartConditionMatcher--><g id="elem_PartConditionMatcher"><rect codeLine="16" fill="#F1F1F1" height="64.4883" id="PartConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="224" x="292" y="446.2656"/><ellipse cx="325.9" cy="462.2656" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M326.0133,457.6138 L324.8595,462.6855 L327.1754,462.6855 Z M324.5191,455.3726 L327.5157,455.3726 L330.8609,467.7656 L328.4122,467.7656 L327.6485,464.7026 L324.3697,464.7026 L323.6227,467.7656 L321.1739,467.7656 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="150" x="344.1" y="467.5566">PartConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="293" x2="515" y1="478.2656" y2="478.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="212" x="298" y="495.8008">val partExtractor: PartExtractor</text><line style="stroke:#181818;stroke-width:0.5;" x1="293" x2="515" y1="502.7539" y2="502.7539"/></g><!--MD5=[e2aa2685189fc4043ed5df0456f4e857]
class AllConditionMatcher--><g id="elem_AllConditionMatcher"><rect codeLine="19" fill="#F1F1F1" height="48" id="AllConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="173" x="551.5" y="454.2656"/><ellipse cx="566.5" cy="470.2656" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M569.4731,475.9087 Q568.8921,476.2075 568.2529,476.3569 Q567.6138,476.5063 566.9082,476.5063 Q564.4014,476.5063 563.0815,474.8545 Q561.7617,473.2026 561.7617,470.0815 Q561.7617,466.9521 563.0815,465.3003 Q564.4014,463.6484 566.9082,463.6484 Q567.6138,463.6484 568.2612,463.7979 Q568.9087,463.9473 569.4731,464.2461 L569.4731,466.9688 Q568.8423,466.3877 568.2488,466.1179 Q567.6553,465.8481 567.0244,465.8481 Q565.6797,465.8481 564.9949,466.9148 Q564.3101,467.9814 564.3101,470.0815 Q564.3101,472.1733 564.9949,473.24 Q565.6797,474.3066 567.0244,474.3066 Q567.6553,474.3066 568.2488,474.0369 Q568.8423,473.7671 569.4731,473.186 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="580.5" y="475.5566">AllConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="552.5" x2="723.5" y1="486.2656" y2="486.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="552.5" x2="723.5" y1="494.2656" y2="494.2656"/></g><!--MD5=[70e7cb1992b484062895f3bda53b9987]
class AuthenticatedConditionMatcher--><g id="elem_AuthenticatedConditionMatcher"><rect codeLine="20" fill="#F1F1F1" height="48" id="AuthenticatedConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="251" x="759.5" y="454.2656"/><ellipse cx="774.5" cy="470.2656" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M777.4731,475.9087 Q776.8921,476.2075 776.2529,476.3569 Q775.6138,476.5063 774.9082,476.5063 Q772.4014,476.5063 771.0815,474.8545 Q769.7617,473.2026 769.7617,470.0815 Q769.7617,466.9521 771.0815,465.3003 Q772.4014,463.6484 774.9082,463.6484 Q775.6138,463.6484 776.2612,463.7979 Q776.9087,463.9473 777.4731,464.2461 L777.4731,466.9688 Q776.8423,466.3877 776.2488,466.1179 Q775.6553,465.8481 775.0244,465.8481 Q773.6797,465.8481 772.9949,466.9148 Q772.3101,467.9814 772.3101,470.0815 Q772.3101,472.1733 772.9949,473.24 Q773.6797,474.3066 775.0244,474.3066 Q775.6553,474.3066 776.2488,474.0369 Q776.8423,473.7671 777.4731,473.186 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="219" x="788.5" y="475.5566">AuthenticatedConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="760.5" x2="1009.5" y1="486.2656" y2="486.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="760.5" x2="1009.5" y1="494.2656" y2="494.2656"/></g><!--MD5=[f6229809f57382abe163f2cd9bed943d]
class EqConditionMatcher--><g id="elem_EqConditionMatcher"><rect codeLine="21" fill="#F1F1F1" height="48" id="EqConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="7" y="570.2656"/><ellipse cx="22" cy="586.2656" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M24.9731,591.9087 Q24.3921,592.2075 23.7529,592.3569 Q23.1138,592.5063 22.4082,592.5063 Q19.9014,592.5063 18.5815,590.8545 Q17.2617,589.2026 17.2617,586.0815 Q17.2617,582.9521 18.5815,581.3003 Q19.9014,579.6484 22.4082,579.6484 Q23.1138,579.6484 23.7612,579.7979 Q24.4087,579.9473 24.9731,580.2461 L24.9731,582.9688 Q24.3423,582.3877 23.7488,582.1179 Q23.1553,581.8481 22.5244,581.8481 Q21.1797,581.8481 20.4949,582.9148 Q19.8101,583.9814 19.8101,586.0815 Q19.8101,588.1733 20.4949,589.24 Q21.1797,590.3066 22.5244,590.3066 Q23.1553,590.3066 23.7488,590.0369 Q24.3423,589.7671 24.9731,589.186 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="36" y="591.5566">EqConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="178" y1="602.2656" y2="602.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="178" y1="610.2656" y2="610.2656"/></g><!--MD5=[47f22ce5c607cbc4aa02c4860af6b9ca]
class InConditionMatcher--><g id="elem_InConditionMatcher"><rect codeLine="22" fill="#F1F1F1" height="48" id="InConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="214" y="570.2656"/><ellipse cx="229" cy="586.2656" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M231.9731,591.9087 Q231.3921,592.2075 230.7529,592.3569 Q230.1138,592.5063 229.4082,592.5063 Q226.9014,592.5063 225.5815,590.8545 Q224.2617,589.2026 224.2617,586.0815 Q224.2617,582.9521 225.5815,581.3003 Q226.9014,579.6484 229.4082,579.6484 Q230.1138,579.6484 230.7612,579.7979 Q231.4087,579.9473 231.9731,580.2461 L231.9731,582.9688 Q231.3423,582.3877 230.7488,582.1179 Q230.1553,581.8481 229.5244,581.8481 Q228.1797,581.8481 227.4949,582.9148 Q226.8101,583.9814 226.8101,586.0815 Q226.8101,588.1733 227.4949,589.24 Q228.1797,590.3066 229.5244,590.3066 Q230.1553,590.3066 230.7488,590.0369 Q231.3423,589.7671 231.9731,589.186 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="243" y="591.5566">InConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="215" x2="381" y1="602.2656" y2="602.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="215" x2="381" y1="610.2656" y2="610.2656"/></g><!--MD5=[495bdeaa6326830d1136252c5454ecbe]
class InDefaultTenantConditionMatcher--><g id="elem_InDefaultTenantConditionMatcher"><rect codeLine="23" fill="#F1F1F1" height="48" id="InDefaultTenantConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="265" x="1045.5" y="454.2656"/><ellipse cx="1060.5" cy="470.2656" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1063.4731,475.9087 Q1062.8921,476.2075 1062.2529,476.3569 Q1061.6138,476.5063 1060.9082,476.5063 Q1058.4014,476.5063 1057.0815,474.8545 Q1055.7617,473.2026 1055.7617,470.0815 Q1055.7617,466.9521 1057.0815,465.3003 Q1058.4014,463.6484 1060.9082,463.6484 Q1061.6138,463.6484 1062.2612,463.7979 Q1062.9087,463.9473 1063.4731,464.2461 L1063.4731,466.9688 Q1062.8423,466.3877 1062.2488,466.1179 Q1061.6553,465.8481 1061.0244,465.8481 Q1059.6797,465.8481 1058.9949,466.9148 Q1058.3101,467.9814 1058.3101,470.0815 Q1058.3101,472.1733 1058.9949,473.24 Q1059.6797,474.3066 1061.0244,474.3066 Q1061.6553,474.3066 1062.2488,474.0369 Q1062.8423,473.7671 1063.4731,473.186 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="233" x="1074.5" y="475.5566">InDefaultTenantConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="1046.5" x2="1309.5" y1="486.2656" y2="486.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="1046.5" x2="1309.5" y1="494.2656" y2="494.2656"/></g><!--MD5=[82bc2e1fc118aa9710a3323191d916ee]
class InPlatformTenantConditionMatcher--><g id="elem_InPlatformTenantConditionMatcher"><rect codeLine="24" fill="#F1F1F1" height="48" id="InPlatformTenantConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="274" x="1346" y="454.2656"/><ellipse cx="1361" cy="470.2656" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1363.9731,475.9087 Q1363.3921,476.2075 1362.7529,476.3569 Q1362.1138,476.5063 1361.4082,476.5063 Q1358.9014,476.5063 1357.5815,474.8545 Q1356.2617,473.2026 1356.2617,470.0815 Q1356.2617,466.9521 1357.5815,465.3003 Q1358.9014,463.6484 1361.4082,463.6484 Q1362.1138,463.6484 1362.7612,463.7979 Q1363.4087,463.9473 1363.9731,464.2461 L1363.9731,466.9688 Q1363.3423,466.3877 1362.7488,466.1179 Q1362.1553,465.8481 1361.5244,465.8481 Q1360.1797,465.8481 1359.4949,466.9148 Q1358.8101,467.9814 1358.8101,470.0815 Q1358.8101,472.1733 1359.4949,473.24 Q1360.1797,474.3066 1361.5244,474.3066 Q1362.1553,474.3066 1362.7488,474.0369 Q1363.3423,473.7671 1363.9731,473.186 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="242" x="1375" y="475.5566">InPlatformTenantConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="1347" x2="1619" y1="486.2656" y2="486.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="1347" x2="1619" y1="494.2656" y2="494.2656"/></g><!--MD5=[67f692ddb2057839c61b25e090b7cfa6]
class InUserTenantConditionMatcher--><g id="elem_InUserTenantConditionMatcher"><rect codeLine="25" fill="#F1F1F1" height="48" id="InUserTenantConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="247" x="1655.5" y="454.2656"/><ellipse cx="1670.5" cy="470.2656" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1673.4731,475.9087 Q1672.8921,476.2075 1672.2529,476.3569 Q1671.6138,476.5063 1670.9082,476.5063 Q1668.4014,476.5063 1667.0815,474.8545 Q1665.7617,473.2026 1665.7617,470.0815 Q1665.7617,466.9521 1667.0815,465.3003 Q1668.4014,463.6484 1670.9082,463.6484 Q1671.6138,463.6484 1672.2612,463.7979 Q1672.9087,463.9473 1673.4731,464.2461 L1673.4731,466.9688 Q1672.8423,466.3877 1672.2488,466.1179 Q1671.6553,465.8481 1671.0244,465.8481 Q1669.6797,465.8481 1668.9949,466.9148 Q1668.3101,467.9814 1668.3101,470.0815 Q1668.3101,472.1733 1668.9949,473.24 Q1669.6797,474.3066 1671.0244,474.3066 Q1671.6553,474.3066 1672.2488,474.0369 Q1672.8423,473.7671 1673.4731,473.186 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="215" x="1684.5" y="475.5566">InUserTenantConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="1656.5" x2="1901.5" y1="486.2656" y2="486.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="1656.5" x2="1901.5" y1="494.2656" y2="494.2656"/></g><!--MD5=[19ac766db96236488bee6fad4c159936]
class NoneConditionMatcher--><g id="elem_NoneConditionMatcher"><rect codeLine="26" fill="#F1F1F1" height="48" id="NoneConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="191" x="1937.5" y="454.2656"/><ellipse cx="1952.5" cy="470.2656" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1955.4731,475.9087 Q1954.8921,476.2075 1954.2529,476.3569 Q1953.6138,476.5063 1952.9082,476.5063 Q1950.4014,476.5063 1949.0815,474.8545 Q1947.7617,473.2026 1947.7617,470.0815 Q1947.7617,466.9521 1949.0815,465.3003 Q1950.4014,463.6484 1952.9082,463.6484 Q1953.6138,463.6484 1954.2612,463.7979 Q1954.9087,463.9473 1955.4731,464.2461 L1955.4731,466.9688 Q1954.8423,466.3877 1954.2488,466.1179 Q1953.6553,465.8481 1953.0244,465.8481 Q1951.6797,465.8481 1950.9949,466.9148 Q1950.3101,467.9814 1950.3101,470.0815 Q1950.3101,472.1733 1950.9949,473.24 Q1951.6797,474.3066 1953.0244,474.3066 Q1953.6553,474.3066 1954.2488,474.0369 Q1954.8423,473.7671 1955.4731,473.186 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="1966.5" y="475.5566">NoneConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="1938.5" x2="2127.5" y1="486.2656" y2="486.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="1938.5" x2="2127.5" y1="494.2656" y2="494.2656"/></g><!--MD5=[f22d5cd5525ea418877d7bd91201372d]
class OgnlConditionMatcher--><g id="elem_OgnlConditionMatcher"><rect codeLine="27" fill="#F1F1F1" height="48" id="OgnlConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="188" x="2164" y="454.2656"/><ellipse cx="2179" cy="470.2656" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2181.9731,475.9087 Q2181.3921,476.2075 2180.7529,476.3569 Q2180.1138,476.5063 2179.4082,476.5063 Q2176.9014,476.5063 2175.5815,474.8545 Q2174.2617,473.2026 2174.2617,470.0815 Q2174.2617,466.9521 2175.5815,465.3003 Q2176.9014,463.6484 2179.4082,463.6484 Q2180.1138,463.6484 2180.7612,463.7979 Q2181.4087,463.9473 2181.9731,464.2461 L2181.9731,466.9688 Q2181.3423,466.3877 2180.7488,466.1179 Q2180.1553,465.8481 2179.5244,465.8481 Q2178.1797,465.8481 2177.4949,466.9148 Q2176.8101,467.9814 2176.8101,470.0815 Q2176.8101,472.1733 2177.4949,473.24 Q2178.1797,474.3066 2179.5244,474.3066 Q2180.1553,474.3066 2180.7488,474.0369 Q2181.3423,473.7671 2181.9731,473.186 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="2193" y="475.5566">OgnlConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="2165" x2="2351" y1="486.2656" y2="486.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="2165" x2="2351" y1="494.2656" y2="494.2656"/></g><!--MD5=[39c596482bf84c0114d9706ba1a57abb]
class PathConditionMatcher--><g id="elem_PathConditionMatcher"><rect codeLine="28" fill="#F1F1F1" height="48" id="PathConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="185" x="417.5" y="570.2656"/><ellipse cx="432.5" cy="586.2656" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M435.4731,591.9087 Q434.8921,592.2075 434.2529,592.3569 Q433.6138,592.5063 432.9082,592.5063 Q430.4014,592.5063 429.0815,590.8545 Q427.7617,589.2026 427.7617,586.0815 Q427.7617,582.9521 429.0815,581.3003 Q430.4014,579.6484 432.9082,579.6484 Q433.6138,579.6484 434.2612,579.7979 Q434.9087,579.9473 435.4731,580.2461 L435.4731,582.9688 Q434.8423,582.3877 434.2488,582.1179 Q433.6553,581.8481 433.0244,581.8481 Q431.6797,581.8481 430.9949,582.9148 Q430.3101,583.9814 430.3101,586.0815 Q430.3101,588.1733 430.9949,589.24 Q431.6797,590.3066 433.0244,590.3066 Q433.6553,590.3066 434.2488,590.0369 Q434.8423,589.7671 435.4731,589.186 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="153" x="446.5" y="591.5566">PathConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="418.5" x2="601.5" y1="602.2656" y2="602.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="418.5" x2="601.5" y1="610.2656" y2="610.2656"/></g><!--MD5=[6b5e6802f0bcef576996a3a0510b469b]
class RegularConditionMatcher--><g id="elem_RegularConditionMatcher"><rect codeLine="29" fill="#F1F1F1" height="48" id="RegularConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="208" x="638" y="570.2656"/><ellipse cx="653" cy="586.2656" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M655.9731,591.9087 Q655.3921,592.2075 654.7529,592.3569 Q654.1138,592.5063 653.4082,592.5063 Q650.9014,592.5063 649.5815,590.8545 Q648.2617,589.2026 648.2617,586.0815 Q648.2617,582.9521 649.5815,581.3003 Q650.9014,579.6484 653.4082,579.6484 Q654.1138,579.6484 654.7612,579.7979 Q655.4087,579.9473 655.9731,580.2461 L655.9731,582.9688 Q655.3423,582.3877 654.7488,582.1179 Q654.1553,581.8481 653.5244,581.8481 Q652.1797,581.8481 651.4949,582.9148 Q650.8101,583.9814 650.8101,586.0815 Q650.8101,588.1733 651.4949,589.24 Q652.1797,590.3066 653.5244,590.3066 Q654.1553,590.3066 654.7488,590.0369 Q655.3423,589.7671 655.9731,589.186 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="176" x="667" y="591.5566">RegularConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="639" x2="845" y1="602.2656" y2="602.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="639" x2="845" y1="610.2656" y2="610.2656"/></g><!--MD5=[54f4ab5815f221210b92d29bad9421b2]
class SpelConditionMatcher--><g id="elem_SpelConditionMatcher"><rect codeLine="30" fill="#F1F1F1" height="48" id="SpelConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="184" x="2387" y="454.2656"/><ellipse cx="2402" cy="470.2656" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2404.9731,475.9087 Q2404.3921,476.2075 2403.7529,476.3569 Q2403.1138,476.5063 2402.4082,476.5063 Q2399.9014,476.5063 2398.5815,474.8545 Q2397.2617,473.2026 2397.2617,470.0815 Q2397.2617,466.9521 2398.5815,465.3003 Q2399.9014,463.6484 2402.4082,463.6484 Q2403.1138,463.6484 2403.7612,463.7979 Q2404.4087,463.9473 2404.9731,464.2461 L2404.9731,466.9688 Q2404.3423,466.3877 2403.7488,466.1179 Q2403.1553,465.8481 2402.5244,465.8481 Q2401.1797,465.8481 2400.4949,466.9148 Q2399.8101,467.9814 2399.8101,470.0815 Q2399.8101,472.1733 2400.4949,473.24 Q2401.1797,474.3066 2402.5244,474.3066 Q2403.1553,474.3066 2403.7488,474.0369 Q2404.3423,473.7671 2404.9731,473.186 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152" x="2416" y="475.5566">SpelConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="2388" x2="2570" y1="486.2656" y2="486.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="2388" x2="2570" y1="494.2656" y2="494.2656"/></g><!--MD5=[fddfadc2de6135163ef0419b72f6a5f3]
class BoolConditionMatcher--><g id="elem_BoolConditionMatcher"><rect codeLine="31" fill="#F1F1F1" height="48" id="BoolConditionMatcher" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="185" x="2606.5" y="454.2656"/><ellipse cx="2621.5" cy="470.2656" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2624.4731,475.9087 Q2623.8921,476.2075 2623.2529,476.3569 Q2622.6138,476.5063 2621.9082,476.5063 Q2619.4014,476.5063 2618.0815,474.8545 Q2616.7617,473.2026 2616.7617,470.0815 Q2616.7617,466.9521 2618.0815,465.3003 Q2619.4014,463.6484 2621.9082,463.6484 Q2622.6138,463.6484 2623.2612,463.7979 Q2623.9087,463.9473 2624.4731,464.2461 L2624.4731,466.9688 Q2623.8423,466.3877 2623.2488,466.1179 Q2622.6553,465.8481 2622.0244,465.8481 Q2620.6797,465.8481 2619.9949,466.9148 Q2619.3101,467.9814 2619.3101,470.0815 Q2619.3101,472.1733 2619.9949,473.24 Q2620.6797,474.3066 2622.0244,474.3066 Q2622.6553,474.3066 2623.2488,474.0369 Q2623.8423,473.7671 2624.4731,473.186 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="153" x="2635.5" y="475.5566">BoolConditionMatcher</text><line style="stroke:#181818;stroke-width:0.5;" x1="2607.5" x2="2790.5" y1="486.2656" y2="486.2656"/><line style="stroke:#181818;stroke-width:0.5;" x1="2607.5" x2="2790.5" y1="494.2656" y2="494.2656"/></g><!--MD5=[bdb7cf9e45c1a2c85396bf792a7d7532]
reverse link RequestMatcher to ConditionMatcher--><g id="link_RequestMatcher_ConditionMatcher"><path codeLine="33" d="M1631,175.9756 C1631,189.6656 1631,203.1256 1631,213.9256 " fill="none" id="RequestMatcher-backto-ConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1624,176.1356,1631,156.1356,1638,176.1356,1624,176.1356" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[7030faf1d2213cedce1f170f20805d5c]
reverse link ConditionMatcher to AbstractConditionMatcher--><g id="link_ConditionMatcher_AbstractConditionMatcher"><path codeLine="34" d="M1631,284.0556 C1631,296.8056 1631,310.4156 1631,322.1656 " fill="none" id="ConditionMatcher-backto-AbstractConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1624,284.1256,1631,264.1256,1638,284.1256,1624,284.1256" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[81c20f53fbd5eb9256a55d99214f6e22]
reverse link AbstractConditionMatcher to PartConditionMatcher--><g id="link_AbstractConditionMatcher_PartConditionMatcher"><path codeLine="35" d="M1503.56,359.5756 C1298.28,367.9256 882.17,390.6356 534,446.2656 C528.16,447.1956 522.19,448.2556 516.18,449.3956 " fill="none" id="AbstractConditionMatcher-backto-PartConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1503.07,352.5956,1523.33,358.7956,1503.63,366.5856,1503.07,352.5956" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a7d0a6c6babc030e4c19b1fd3635bfe9]
reverse link PartConditionMatcher to InConditionMatcher--><g id="link_PartConditionMatcher_InConditionMatcher"><path codeLine="36" d="M360.16,526.4056 C346.23,541.3956 331.42,557.3256 319.75,569.8756 " fill="none" id="PartConditionMatcher-backto-InConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="354.98,521.7056,373.72,511.8256,365.23,531.2356,354.98,521.7056" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1b123a2ab873b477e49b0d957cc37687]
reverse link PartConditionMatcher to EqConditionMatcher--><g id="link_PartConditionMatcher_EqConditionMatcher"><path codeLine="37" d="M298.2,518.0456 C251.23,535.2656 197.51,554.9556 156.82,569.8756 " fill="none" id="PartConditionMatcher-backto-EqConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="295.59,511.5456,316.77,511.2356,300.4,524.6956,295.59,511.5456" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[93372165fc5dbed7df902244f99c97fe]
reverse link PartConditionMatcher to PathConditionMatcher--><g id="link_PartConditionMatcher_PathConditionMatcher"><path codeLine="38" d="M447.84,526.4056 C461.77,541.3956 476.58,557.3256 488.25,569.8756 " fill="none" id="PartConditionMatcher-backto-PathConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="442.77,531.2356,434.28,511.8256,453.02,521.7056,442.77,531.2356" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[eb9858d59e8ba47725b5202691127579]
reverse link PartConditionMatcher to RegularConditionMatcher--><g id="link_PartConditionMatcher_RegularConditionMatcher"><path codeLine="39" d="M517.58,517.5756 C568.85,534.8656 627.77,554.7356 672.37,569.7856 " fill="none" id="PartConditionMatcher-backto-RegularConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="515.4,524.2256,498.69,511.2056,519.88,510.9656,515.4,524.2256" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[5f88b6312ffbe3ed43a3d2a03c341a34]
reverse link AbstractConditionMatcher to AuthenticatedConditionMatcher--><g id="link_AbstractConditionMatcher_AuthenticatedConditionMatcher"><path codeLine="40" d="M1503.44,372.1156 C1381.13,388.8356 1191.44,416.2456 1028,446.2656 C1015.51,448.5556 1002.44,451.1356 989.5,453.8056 " fill="none" id="AbstractConditionMatcher-backto-AuthenticatedConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1502.47,365.1756,1523.23,369.4256,1504.35,379.0556,1502.47,365.1756" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[7bbf6fa697f69e7ca99856187ffd6761]
reverse link AbstractConditionMatcher to InDefaultTenantConditionMatcher--><g id="link_AbstractConditionMatcher_InDefaultTenantConditionMatcher"><path codeLine="41" d="M1504.06,389.4556 C1427.88,409.9656 1332.95,435.5356 1265.2,453.7856 " fill="none" id="AbstractConditionMatcher-backto-InDefaultTenantConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1501.91,382.7856,1523.04,384.3356,1505.55,396.2956,1501.91,382.7856" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8de97abf4d0376db40989b24ad095d99]
reverse link AbstractConditionMatcher to SpelConditionMatcher--><g id="link_AbstractConditionMatcher_SpelConditionMatcher"><path codeLine="42" d="M1758.46,364.9356 C1906.51,377.5556 2157.62,403.2556 2370,446.2656 C2380.51,448.3956 2391.48,451.0256 2402.25,453.8356 " fill="none" id="AbstractConditionMatcher-backto-SpelConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1758.23,371.9456,1738.89,363.2956,1759.4,357.9856,1758.23,371.9456" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[c38409d17ace6f80aae58399572617cb]
reverse link AbstractConditionMatcher to OgnlConditionMatcher--><g id="link_AbstractConditionMatcher_OgnlConditionMatcher"><path codeLine="43" d="M1758.06,374.2656 C1862.7,390.7356 2014.68,416.5656 2146,446.2656 C2156.04,448.5356 2166.52,451.1356 2176.87,453.8356 " fill="none" id="AbstractConditionMatcher-backto-OgnlConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1757.3,381.2256,1738.62,371.2256,1759.46,367.3956,1757.3,381.2256" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[5792e37acfdfc443282d16637d27747c]
reverse link AbstractConditionMatcher to InUserTenantConditionMatcher--><g id="link_AbstractConditionMatcher_InUserTenantConditionMatcher"><path codeLine="44" d="M1685.45,400.1556 C1707.65,418.4456 1732.38,438.8356 1750.83,454.0456 " fill="none" id="AbstractConditionMatcher-backto-InUserTenantConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1681.26,405.7656,1670.28,387.6456,1690.17,394.9656,1681.26,405.7656" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[88eb24e043adeffe78e09ab939b95bd2]
reverse link AbstractConditionMatcher to NoneConditionMatcher--><g id="link_AbstractConditionMatcher_NoneConditionMatcher"><path codeLine="45" d="M1755.1,392.9256 C1820.58,412.7956 1898.87,436.5556 1955.64,453.7856 " fill="none" id="AbstractConditionMatcher-backto-NoneConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1753.34,399.7056,1736.23,387.2056,1757.41,386.3156,1753.34,399.7056" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[9bff097969e3e5bf439c22c9d5520a68]
reverse link AbstractConditionMatcher to AllConditionMatcher--><g id="link_AbstractConditionMatcher_AllConditionMatcher"><path codeLine="46" d="M1503.2,360.8056 C1329.49,370.0456 1009.8,393.1356 742,446.2656 C731.65,448.3156 720.85,450.9556 710.3,453.8256 " fill="none" id="AbstractConditionMatcher-backto-AllConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1502.83,353.8156,1523.16,359.7756,1503.55,367.7956,1502.83,353.8156" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8c9486041a5414bf29b4f721e174f7cf]
reverse link AbstractConditionMatcher to InPlatformTenantConditionMatcher--><g id="link_AbstractConditionMatcher_InPlatformTenantConditionMatcher"><path codeLine="47" d="M1576.55,400.1556 C1554.35,418.4456 1529.62,438.8356 1511.17,454.0456 " fill="none" id="AbstractConditionMatcher-backto-InPlatformTenantConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1571.83,394.9656,1591.72,387.6456,1580.74,405.7656,1571.83,394.9656" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0b58f43ee337e0004ed3aee8c8beb586]
reverse link AbstractConditionMatcher to BoolConditionMatcher--><g id="link_AbstractConditionMatcher_BoolConditionMatcher"><path codeLine="48" d="M1758.88,360.0956 C1943.53,368.7156 2294.93,391.3256 2589,446.2656 C2599.92,448.3056 2611.33,450.9356 2622.49,453.8056 " fill="none" id="AbstractConditionMatcher-backto-BoolConditionMatcher" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="1758.65,367.0956,1738.99,359.1956,1759.29,353.1056,1758.65,367.0956" style="stroke:#181818;stroke-width:1.0;"/></g><a href="https://github.com/Ahoo-Wang/CoSec" target="_top" title="https://github.com/Ahoo-Wang/CoSec" xlink:actuate="onRequest" xlink:href="https://github.com/Ahoo-Wang/CoSec" xlink:show="new" xlink:title="https://github.com/Ahoo-Wang/CoSec" xlink:type="simple"><text fill="#808080" font-family="sans-serif" font-size="10" lengthAdjust="spacing" text-decoration="underline" textLength="189" x="1297.75" y="633.9336">https://github.com/Ahoo-Wang/CoSec</text></a><!--MD5=[804de4eca55cbf09985c3c66c2fa3f96]
@startuml

!include layout.puml

title Build In ConditionMatcher

interface RequestMatcher{
    val type: String
    val configuration: Configuration
    match(request: Request, securityContext: SecurityContext): Boolean
}

interface ConditionMatcher
abstract class AbstractConditionMatcher{
    val negate: Boolean
}
abstract class PartConditionMatcher{
    val partExtractor: PartExtractor
}
class AllConditionMatcher
class AuthenticatedConditionMatcher
class EqConditionMatcher
class InConditionMatcher
class InDefaultTenantConditionMatcher
class InPlatformTenantConditionMatcher
class InUserTenantConditionMatcher
class NoneConditionMatcher
class OgnlConditionMatcher
class PathConditionMatcher
class RegularConditionMatcher
class SpelConditionMatcher
class BoolConditionMatcher

RequestMatcher <|- - ConditionMatcher
ConditionMatcher <|- - AbstractConditionMatcher
AbstractConditionMatcher <|- - PartConditionMatcher
PartConditionMatcher <|- - InConditionMatcher
PartConditionMatcher <|- - EqConditionMatcher
PartConditionMatcher <|- - PathConditionMatcher
PartConditionMatcher <|- - RegularConditionMatcher
AbstractConditionMatcher <|- - AuthenticatedConditionMatcher
AbstractConditionMatcher <|- - InDefaultTenantConditionMatcher
AbstractConditionMatcher <|- - SpelConditionMatcher
AbstractConditionMatcher <|- - OgnlConditionMatcher
AbstractConditionMatcher <|- - InUserTenantConditionMatcher
AbstractConditionMatcher <|- - NoneConditionMatcher
AbstractConditionMatcher <|- - AllConditionMatcher
AbstractConditionMatcher <|- - InPlatformTenantConditionMatcher
AbstractConditionMatcher <|- - BoolConditionMatcher
@enduml

@startuml

skinparam hyperlinkColor grey


header
[[https://github.com/Ahoo-Wang/CoSec]]
endheader

center footer [[https://github.com/Ahoo-Wang/CoSec]]


title Build In ConditionMatcher

interface RequestMatcher{
    val type: String
    val configuration: Configuration
    match(request: Request, securityContext: SecurityContext): Boolean
}

interface ConditionMatcher
abstract class AbstractConditionMatcher{
    val negate: Boolean
}
abstract class PartConditionMatcher{
    val partExtractor: PartExtractor
}
class AllConditionMatcher
class AuthenticatedConditionMatcher
class EqConditionMatcher
class InConditionMatcher
class InDefaultTenantConditionMatcher
class InPlatformTenantConditionMatcher
class InUserTenantConditionMatcher
class NoneConditionMatcher
class OgnlConditionMatcher
class PathConditionMatcher
class RegularConditionMatcher
class SpelConditionMatcher
class BoolConditionMatcher

RequestMatcher <|- - ConditionMatcher
ConditionMatcher <|- - AbstractConditionMatcher
AbstractConditionMatcher <|- - PartConditionMatcher
PartConditionMatcher <|- - InConditionMatcher
PartConditionMatcher <|- - EqConditionMatcher
PartConditionMatcher <|- - PathConditionMatcher
PartConditionMatcher <|- - RegularConditionMatcher
AbstractConditionMatcher <|- - AuthenticatedConditionMatcher
AbstractConditionMatcher <|- - InDefaultTenantConditionMatcher
AbstractConditionMatcher <|- - SpelConditionMatcher
AbstractConditionMatcher <|- - OgnlConditionMatcher
AbstractConditionMatcher <|- - InUserTenantConditionMatcher
AbstractConditionMatcher <|- - NoneConditionMatcher
AbstractConditionMatcher <|- - AllConditionMatcher
AbstractConditionMatcher <|- - InPlatformTenantConditionMatcher
AbstractConditionMatcher <|- - BoolConditionMatcher
@enduml

PlantUML version 1.2022.13(Sat Nov 19 21:22:17 CST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>